const a2_0x5a4600=a2_0x2dbe;function a2_0x4ba5(){const _0x1761ed=['typeId','233668DxRyIS','connect','token','websocket','Error\x20:\x20','Successfully\x20Claim\x20Misisons','Successfully\x20Buying\x201\x20Grapes','plantSeed','WSS\x20Connection\x20Closed\x20','name','...','/api/v1/auth/telegram','buyingGrapes','Successfully\x20Get\x20User\x20Info','getSeedList','Successfully\x20Get\x20User\x20Land\x20Info','WSS\x20Disconnected:\x20','POST','246678DAbcNu','type','Getting\x20User\x20Info...','Successfully\x20Harvest\x20All\x20Plant\x20Got\x20','socket','message','/api/v1/store/buy','count','WSS\x20Connected...','2507152nlrKBI','wss://cowtopia-ws.tonfarmer.com','Pet\x20','833690RQduiC','harvestAll','Successfully\x20Claim\x20Gold,\x20got\x20','query','info','Try\x20to\x20Login...','Successfully\x20Opening\x20Multiple\x20Chest','Getting\x20Seed\x20List...','entries','account','error','find','getLands','Getting\x20User\x20Land\x20Info...','getChest','getPet','land','map','Successfully\x20Get\x20Player\x20Plant','https://api.catopia.io','seed','GET','data','petTypeId','Successfully\x20Get\x20Misisons','buyChest','Opening\x20multipe\x20chest...','COMPANION','/api/v1/players/plant/harvestAll','/claim','/api/v1/players/pet?limit=3000','plant','pet','getUser','Getting\x20Missions...','15FtVRvg','\x20GEM\x20&\x20','petTypeList','WSS\x20Handshake\x20Error:\x20','success','Claiming\x20Gold...','\x20Grapes','\x20GOLD','600768NxcOHO','gold','upgradePet','connect_error','user','openChest','login','9sUrEnY','title','fetch','Getting\x20Player\x20Plant...','/api/v1/players/land?limit=3000','missions','Successfully\x20planting\x20grapes\x20to\x20land\x20','generateUpgradablePet','/api/v1/seed?limit=3000','claimGold','refreshToken','push','1113721kcMRPq','/api/v1/players/plant','connect_timeout','Successfully\x20Login','claimMission','/api/v1/chest/open-multiple','delay','gem','/api/v1/user-collection/claim-gold','disconnect','plantString','chest','claimedCoin','plainToken','WSS\x20Handshake\x20completed\x20and\x20connected.','mission','queryObj','reduce','initWss','Claiming\x20Missions\x20','accessToken','Socket\x20ID:\x20','WSS\x20Error\x20:\x20','getAvailablePlant','114064AzmasO','petCompanion','\x20Successfully\x20Upgraded\x20to\x20Level\x20','level'];a2_0x4ba5=function(){return _0x1761ed;};return a2_0x4ba5();}function a2_0x2dbe(_0x209f94,_0x3ea8b0){const _0x4ba565=a2_0x4ba5();return a2_0x2dbe=function(_0x2dbe32,_0x4a669c){_0x2dbe32=_0x2dbe32-0x17e;let _0x27438f=_0x4ba565[_0x2dbe32];return _0x27438f;},a2_0x2dbe(_0x209f94,_0x3ea8b0);}(function(_0x57d95c,_0x110e9d){const _0xf8a7b0=a2_0x2dbe,_0x2ad5dd=_0x57d95c();while(!![]){try{const _0x10bade=-parseInt(_0xf8a7b0(0x185))/0x1+parseInt(_0xf8a7b0(0x197))/0x2+parseInt(_0xf8a7b0(0x1c6))/0x3*(parseInt(_0xf8a7b0(0x180))/0x4)+parseInt(_0xf8a7b0(0x1a3))/0x5+parseInt(_0xf8a7b0(0x1ce))/0x6+parseInt(_0xf8a7b0(0x1e1))/0x7+-parseInt(_0xf8a7b0(0x1a0))/0x8*(parseInt(_0xf8a7b0(0x1d5))/0x9);if(_0x10bade===_0x110e9d)break;else _0x2ad5dd['push'](_0x2ad5dd['shift']());}catch(_0x7554ca){_0x2ad5dd['push'](_0x2ad5dd['shift']());}}}(a2_0x4ba5,0x235ba));import{API}from'../api/api.js';import{Helper}from'../utils/helper.js';import a2_0x4190c3 from'../utils/logger.js';import{io}from'socket.io-client';import{PetList}from'./pet_list.js';import{Config}from'../../config/config.js';export class Catopia extends API{constructor(_0x58cc45,_0x1d5c29,_0x4c3c0a,_0x55b457){const _0x402447=a2_0x2dbe;super(_0x1d5c29,_0x402447(0x1b6),_0x55b457),this[_0x402447(0x1ac)]=_0x58cc45,this[_0x402447(0x1a6)]=_0x1d5c29,this[_0x402447(0x1f1)]=_0x4c3c0a;}async[a2_0x5a4600(0x1d4)](){const _0x8415ff=a2_0x5a4600;try{await Helper[_0x8415ff(0x1e7)](0x1f4,this[_0x8415ff(0x1ac)],_0x8415ff(0x1a8),this);const _0x1310a6=await this['fetch'](_0x8415ff(0x190),'POST',undefined,{'initData':this[_0x8415ff(0x1a6)]});await Helper['delay'](0x3e8,this[_0x8415ff(0x1ac)],_0x8415ff(0x1e4),this),this[_0x8415ff(0x187)]=_0x1310a6[_0x8415ff(0x1b9)][_0x8415ff(0x1f5)],this[_0x8415ff(0x1df)]=_0x1310a6[_0x8415ff(0x1df)];}catch(_0x57219a){throw _0x57219a;}}async[a2_0x5a4600(0x1c4)](_0x3bc649=![]){const _0x4f42ac=a2_0x5a4600;try{if(_0x3bc649)await Helper['delay'](0x1f4,this['account'],_0x4f42ac(0x199),this);const _0x2540f2=await this[_0x4f42ac(0x1d7)]('/api/v1/user-collection?limit=3000',_0x4f42ac(0x1b8),this['token']);if(_0x2540f2['success']==!![]){if(_0x3bc649)await Helper[_0x4f42ac(0x1e7)](0x3e8,this['account'],_0x4f42ac(0x192),this);this[_0x4f42ac(0x1d2)]=_0x2540f2['data'];}else await Helper['delay'](0x1388,this[_0x4f42ac(0x1ac)],'Error\x20:\x20'+_0x2540f2[_0x4f42ac(0x19c)],this);}catch(_0x28091d){throw _0x28091d;}}async[a2_0x5a4600(0x1f3)](){return new Promise(async(_0x515afe,_0x4b9f1e)=>{const _0x5e69b2=a2_0x2dbe;await Helper[_0x5e69b2(0x1e7)](0x3e8,this['account'],'Connecting\x20to\x20WSS...',this),this['socket']=io(_0x5e69b2(0x1a1),{'auth':{'token':this[_0x5e69b2(0x1ee)]},'transports':[_0x5e69b2(0x188)]}),this[_0x5e69b2(0x19b)]['on'](_0x5e69b2(0x186),async()=>{const _0x7bad7f=_0x5e69b2;await Helper[_0x7bad7f(0x1e7)](0x3e8,this['account'],_0x7bad7f(0x19f),this),a2_0x4190c3['info'](_0x7bad7f(0x1ef)),a2_0x4190c3[_0x7bad7f(0x1a7)](_0x7bad7f(0x1f6)+this['socket']['id']),_0x515afe();}),this[_0x5e69b2(0x19b)]['on'](_0x5e69b2(0x1d1),async _0x44b060=>{const _0x4acb66=_0x5e69b2;await Helper['delay'](0x3e8,this[_0x4acb66(0x1ac)],'WSS\x20Connection\x20Error:\x20'+_0x44b060[_0x4acb66(0x19c)],this),a2_0x4190c3[_0x4acb66(0x1ad)](_0x4acb66(0x1c9)+_0x44b060['message']),_0x4b9f1e(_0x44b060);}),this[_0x5e69b2(0x19b)]['on'](_0x5e69b2(0x1e3),async()=>{const _0x4d1c9a=_0x5e69b2;await Helper[_0x4d1c9a(0x1e7)](0x3e8,this[_0x4d1c9a(0x1ac)],'WSS\x20Connection\x20Timeout',this),a2_0x4190c3[_0x4d1c9a(0x1ad)]('WSS\x20Handshake\x20Timeout'),_0x4b9f1e(new Error('WSS\x20Handshake\x20Timeout'));}),this[_0x5e69b2(0x19b)]['on'](_0x5e69b2(0x1ad),async _0x4dc90d=>{const _0x4525bf=_0x5e69b2;await Helper[_0x4525bf(0x1e7)](0x3e8,this[_0x4525bf(0x1ac)],'WSS\x20Error\x20:\x20'+_0x4dc90d['message'],this),a2_0x4190c3['error'](_0x4525bf(0x17e)+_0x4dc90d[_0x4525bf(0x19c)]),_0x4b9f1e(_0x4dc90d);}),this['socket']['on'](_0x5e69b2(0x1ea),async _0x5dd840=>{const _0x231b3d=_0x5e69b2;await Helper[_0x231b3d(0x1e7)](0x3e8,this[_0x231b3d(0x1ac)],_0x231b3d(0x18d)+_0x5dd840+'...',this),a2_0x4190c3[_0x231b3d(0x1a7)](_0x231b3d(0x195)+_0x5dd840);});});}async['getMission'](_0x106c2d=![]){const _0x25e34c=a2_0x5a4600;try{if(_0x106c2d)await Helper[_0x25e34c(0x1e7)](0x1f4,this[_0x25e34c(0x1ac)],_0x25e34c(0x1c5),this);this['missions']=[];const _0x35fa12=await this[_0x25e34c(0x1d7)]('/api/v1/user/daily-mission?limit=3000',_0x25e34c(0x1b8),this[_0x25e34c(0x187)]);if(_0x35fa12[_0x25e34c(0x1ca)]){if(_0x106c2d)await Helper[_0x25e34c(0x1e7)](0x3e8,this[_0x25e34c(0x1ac)],_0x25e34c(0x1bb),this);this[_0x25e34c(0x1da)]=_0x35fa12[_0x25e34c(0x1b9)];}else await Helper[_0x25e34c(0x1e7)](0x1388,this['account'],_0x25e34c(0x189)+_0x35fa12['message'],this);}catch(_0x15f6d8){throw _0x15f6d8;}}async[a2_0x5a4600(0x1e5)](_0x4e5e18){const _0x763146=a2_0x5a4600;try{await Helper[_0x763146(0x1e7)](0x1f4,this[_0x763146(0x1ac)],_0x763146(0x1f4)+_0x4e5e18[_0x763146(0x1f0)][_0x763146(0x1d6)]+'...',this);const _0x2b37b6=await this[_0x763146(0x1d7)]('/api/v1/user/daily-mission/'+_0x4e5e18['id']+_0x763146(0x1c0),_0x763146(0x196),this[_0x763146(0x187)]);_0x2b37b6[_0x763146(0x1ca)]?(await Helper['delay'](0x3e8,this[_0x763146(0x1ac)],_0x763146(0x18a),this),await this[_0x763146(0x1c4)](),await this['getMission']()):await Helper[_0x763146(0x1e7)](0x1388,this['account'],_0x763146(0x189)+_0x2b37b6['message'],this);}catch(_0x52a9c1){throw _0x52a9c1;}}async[a2_0x5a4600(0x193)](){const _0x593042=a2_0x5a4600;try{await Helper[_0x593042(0x1e7)](0x1f4,this['account'],_0x593042(0x1aa),this);const _0x3c1107=await this[_0x593042(0x1d7)](_0x593042(0x1dd),'GET',this[_0x593042(0x187)]);_0x3c1107['success']?(await Helper[_0x593042(0x1e7)](0x3e8,this['account'],'Successfully\x20Get\x20Seed\x20List',this),this[_0x593042(0x1b7)]=_0x3c1107[_0x593042(0x1b9)]):await Helper[_0x593042(0x1e7)](0x1388,this[_0x593042(0x1ac)],_0x593042(0x189)+_0x3c1107[_0x593042(0x19c)],this);}catch(_0x274a2b){throw _0x274a2b;}}async[a2_0x5a4600(0x17f)](_0x2514b5=![]){const _0x53b0a4=a2_0x5a4600;try{if(_0x2514b5)await Helper[_0x53b0a4(0x1e7)](0x1f4,this[_0x53b0a4(0x1ac)],_0x53b0a4(0x1d8),this);const _0x57446a=await this[_0x53b0a4(0x1d7)]('/api/v1/players/plant?limit=3000',_0x53b0a4(0x1b8),this['token']);if(_0x57446a[_0x53b0a4(0x1ca)]){if(_0x2514b5)await Helper[_0x53b0a4(0x1e7)](0x3e8,this[_0x53b0a4(0x1ac)],_0x53b0a4(0x1b5),this);this['plant']=_0x57446a[_0x53b0a4(0x1b9)];const _0x4189cd=this[_0x53b0a4(0x1c2)][_0x53b0a4(0x1f2)]((_0x2f8f76,_0x150a16)=>{const _0x1ab36f=_0x53b0a4,_0x54190f=_0x150a16[_0x1ab36f(0x18e)];return _0x2f8f76[_0x54190f]=(_0x2f8f76[_0x54190f]||0x0)+0x1,_0x2f8f76;},{});this[_0x53b0a4(0x1eb)]=Object[_0x53b0a4(0x1ab)](_0x4189cd)[_0x53b0a4(0x1b4)](([_0x341fb3,_0x258ea9])=>_0x258ea9+_0x53b0a4(0x1cc))['join']('\x20'),(this[_0x53b0a4(0x1eb)]==''||this['plantString']==undefined)&&(this[_0x53b0a4(0x1eb)]='0\x20Grapes');}else await Helper['delay'](0x1388,this[_0x53b0a4(0x1ac)],_0x53b0a4(0x189)+_0x57446a[_0x53b0a4(0x19c)],this);}catch(_0x2cdf4c){throw _0x2cdf4c;}}async[a2_0x5a4600(0x191)](){const _0x98f2a9=a2_0x5a4600;try{await Helper['delay'](0x1f4,this[_0x98f2a9(0x1ac)],'Buying\x20Grapes...',this);const _0x23a0ed=await this[_0x98f2a9(0x1d7)](_0x98f2a9(0x19d),_0x98f2a9(0x196),this[_0x98f2a9(0x187)],{'storeId':0x11,'price':0x3e80,'unit':0x1});await this[_0x98f2a9(0x1c4)](),_0x23a0ed[_0x98f2a9(0x1ca)]?(await Helper[_0x98f2a9(0x1e7)](0x3e8,this[_0x98f2a9(0x1ac)],_0x98f2a9(0x18b),this),await this[_0x98f2a9(0x17f)]()):(await Helper[_0x98f2a9(0x1e7)](0x1388,this[_0x98f2a9(0x1ac)],''+_0x23a0ed[_0x98f2a9(0x19c)],this),await this['harvestAll']());}catch(_0x14d9bd){throw _0x14d9bd;}}async[a2_0x5a4600(0x1af)](_0x2b4f20=![]){const _0x1a9be4=a2_0x5a4600;try{if(_0x2b4f20)await Helper[_0x1a9be4(0x1e7)](0x1f4,this[_0x1a9be4(0x1ac)],_0x1a9be4(0x1b0),this);const _0x395998=await this[_0x1a9be4(0x1d7)](_0x1a9be4(0x1d9),_0x1a9be4(0x1b8),this[_0x1a9be4(0x187)]);if(_0x395998[_0x1a9be4(0x1ca)]){if(_0x2b4f20)await Helper[_0x1a9be4(0x1e7)](0x3e8,this[_0x1a9be4(0x1ac)],_0x1a9be4(0x194),this);this[_0x1a9be4(0x1b3)]=_0x395998[_0x1a9be4(0x1b9)];}else await Helper['delay'](0x1388,this[_0x1a9be4(0x1ac)],_0x1a9be4(0x189)+_0x395998[_0x1a9be4(0x19c)],this);}catch(_0xe02c1d){throw _0xe02c1d;}}async[a2_0x5a4600(0x18c)](_0x9a1794){const _0x27143e=a2_0x5a4600;try{await Helper[_0x27143e(0x1e7)](0x1f4,this[_0x27143e(0x1ac)],'Planting\x20Gapes\x20seed\x20to\x20land...',this);const _0x28471d=await this[_0x27143e(0x1d7)](_0x27143e(0x1e2),'POSt',this['token'],{'plantId':this[_0x27143e(0x1c2)][0x0]['id'],'landId':_0x9a1794});_0x28471d[_0x27143e(0x1ca)]?(await Helper[_0x27143e(0x1e7)](0x3e8,this['account'],_0x27143e(0x1db)+_0x9a1794,this),await this['getLands'](),await this[_0x27143e(0x17f)]()):await Helper[_0x27143e(0x1e7)](0x1388,this[_0x27143e(0x1ac)],'Error\x20:\x20'+_0x28471d['message'],this);}catch(_0x6aa8d2){throw _0x6aa8d2;}}async[a2_0x5a4600(0x1a4)](){const _0x129dab=a2_0x5a4600;try{await Helper[_0x129dab(0x1e7)](0x1f4,this[_0x129dab(0x1ac)],'Harvesting\x20all...',this);const _0x21622a=await this['fetch'](_0x129dab(0x1bf),'POSt',this[_0x129dab(0x187)]);_0x21622a[_0x129dab(0x1ca)]?(await Helper[_0x129dab(0x1e7)](0x7d0,this['account'],_0x129dab(0x19a)+_0x21622a[_0x129dab(0x1b9)][_0x129dab(0x1e8)]+_0x129dab(0x1c7)+_0x21622a[_0x129dab(0x1b9)][_0x129dab(0x1cf)]+_0x129dab(0x1cd),this),await this[_0x129dab(0x1c4)](),await this[_0x129dab(0x1af)](),await this[_0x129dab(0x17f)]()):await Helper[_0x129dab(0x1e7)](0x7d0,this[_0x129dab(0x1ac)],''+_0x21622a[_0x129dab(0x19c)],this);}catch(_0x2d5177){throw _0x2d5177;}}async[a2_0x5a4600(0x1b2)](_0x152edc){const _0x7ef748=a2_0x5a4600;try{if(_0x152edc)await Helper[_0x7ef748(0x1e7)](0x1f4,this[_0x7ef748(0x1ac)],'Getting\x20player\x20pet...',this);const _0x17ef1e=await this[_0x7ef748(0x1d7)](_0x7ef748(0x1c1),_0x7ef748(0x1b8),this[_0x7ef748(0x187)]);if(_0x17ef1e[_0x7ef748(0x1ca)]){if(_0x152edc)await Helper[_0x7ef748(0x1e7)](0xbb8,this[_0x7ef748(0x1ac)],'Successfully\x20get\x20player\x20pet',this);this['pet']=_0x17ef1e[_0x7ef748(0x1b9)];}else await Helper['delay'](0xbb8,this['account'],''+_0x17ef1e[_0x7ef748(0x19c)],this);}catch(_0x2a293f){throw _0x2a293f;}}async[a2_0x5a4600(0x1bc)](){const _0x105bfc=a2_0x5a4600;try{await Helper['delay'](0x1f4,this['account'],'Buying\x20common\x20chest...',this);const _0x2071b9=await this[_0x105bfc(0x1d7)](_0x105bfc(0x19d),_0x105bfc(0x196),this['token'],{'storeId':0x2,'price':0x7530,'unit':0x1});_0x2071b9['success']?(await this[_0x105bfc(0x1c4)](),await this['getChest']()):await Helper[_0x105bfc(0x1e7)](0xbb8,this[_0x105bfc(0x1ac)],''+_0x2071b9[_0x105bfc(0x19c)],this);}catch(_0x26ecd4){throw _0x26ecd4;}}async['getChest'](){const _0x140446=a2_0x5a4600;try{const _0x23bcf0=await this['fetch']('/api/v1/players/chest?limit=3000',_0x140446(0x1b8),this[_0x140446(0x187)]);_0x23bcf0[_0x140446(0x1ca)]?this['chest']=_0x23bcf0['data']:await Helper[_0x140446(0x1e7)](0xbb8,this[_0x140446(0x1ac)],''+res[_0x140446(0x19c)],this);}catch(_0x162022){throw _0x162022;}}async[a2_0x5a4600(0x1d3)](){const _0x52a941=a2_0x5a4600;try{const _0x5e6a09=Config[_0x52a941(0x1be)]??'A';await Helper['delay'](0x1f4,this[_0x52a941(0x1ac)],_0x52a941(0x1bd),this);const _0x29a790=await this[_0x52a941(0x1d7)](_0x52a941(0x1e6),_0x52a941(0x196),this[_0x52a941(0x187)],{'petTypeIds':PetList[_0x52a941(0x181)][_0x52a941(0x1ae)](_0x2300cb=>_0x2300cb[_0x52a941(0x198)]==_0x5e6a09)['data'],'chestIds':this[_0x52a941(0x1ec)][_0x52a941(0x1b4)](_0x59b481=>{return _0x59b481['id'];})});_0x29a790[_0x52a941(0x1ca)]?(await this[_0x52a941(0x1b1)](),await Helper[_0x52a941(0x1e7)](0x3e8,this[_0x52a941(0x1ac)],_0x52a941(0x1a9),this)):await Helper[_0x52a941(0x1e7)](0xbb8,this[_0x52a941(0x1ac)],''+_0x29a790['message'],this);}catch(_0x1b35ed){throw _0x1b35ed;}}async[a2_0x5a4600(0x1d0)](_0x586cb7){const _0x59453f=a2_0x5a4600;try{await Helper[_0x59453f(0x1e7)](0x1f4,this[_0x59453f(0x1ac)],'Upgrading\x20pet\x20'+_0x586cb7[_0x59453f(0x184)]+'\x20Level\x20'+_0x586cb7['level']+_0x59453f(0x18f),this);const _0x361ec5=PetList[_0x59453f(0x1c8)][_0x59453f(0x1ae)](_0x1e0b78=>_0x1e0b78[_0x59453f(0x1ba)]==_0x586cb7[_0x59453f(0x184)]),_0x1b855e=await this[_0x59453f(0x1d7)]('/api/v1/players/pet/upgrade',_0x59453f(0x196),this[_0x59453f(0x187)],{'level':_0x586cb7[_0x59453f(0x183)],'petTypeId':_0x361ec5['petTypeId']});_0x1b855e['success']?(await this['getPet'](),await Helper[_0x59453f(0x1e7)](0x3e8,this[_0x59453f(0x1ac)],_0x59453f(0x1a2)+_0x586cb7[_0x59453f(0x184)]+_0x59453f(0x182)+(_0x586cb7[_0x59453f(0x183)]+0x1)+'\x20',this)):await Helper['delay'](0xbb8,this[_0x59453f(0x1ac)],''+_0x1b855e[_0x59453f(0x19c)],this);}catch(_0xffd68){throw _0xffd68;}}async[a2_0x5a4600(0x1de)](){const _0x57b10c=a2_0x5a4600;try{await Helper[_0x57b10c(0x1e7)](0x1f4,this['account'],_0x57b10c(0x1cb),this);const _0x5d76c6=await this['fetch'](_0x57b10c(0x1e9),'POST',this[_0x57b10c(0x187)]);_0x5d76c6[_0x57b10c(0x1ca)]?(await this[_0x57b10c(0x1c4)](),await Helper['delay'](0x3e8,this['account'],_0x57b10c(0x1a5)+_0x5d76c6[_0x57b10c(0x1b9)][_0x57b10c(0x1ed)]+_0x57b10c(0x1cd),this)):await Helper[_0x57b10c(0x1e7)](0xbb8,this[_0x57b10c(0x1ac)],''+_0x5d76c6[_0x57b10c(0x19c)],this);}catch(_0x1787ff){throw _0x1787ff;}}async[a2_0x5a4600(0x1dc)](){const _0xe8eb3=a2_0x5a4600;let _0x4af2f3=[];for(const _0x2b83f1 of this[_0xe8eb3(0x1c3)]){const _0x490a7d=_0x4af2f3[_0xe8eb3(0x1ae)](_0x304fd4=>_0x304fd4[_0xe8eb3(0x18e)]===_0x2b83f1['name']&&_0x304fd4[_0xe8eb3(0x183)]===_0x2b83f1[_0xe8eb3(0x183)]);_0x490a7d?_0x490a7d[_0xe8eb3(0x19e)]+=0x1:_0x4af2f3[_0xe8eb3(0x1e0)]({..._0x2b83f1,'count':0x1});}return _0x4af2f3=_0x4af2f3['filter'](_0x1cb4ad=>_0x1cb4ad[_0xe8eb3(0x19e)]>=0x5),_0x4af2f3;}}