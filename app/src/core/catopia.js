const a2_0x5f162a=a2_0x57d7;(function(_0x5c5ba8,_0xd91aa){const _0x151441=a2_0x57d7,_0x1c9c8b=_0x5c5ba8();while(!![]){try{const _0x27dbe5=parseInt(_0x151441(0xb7))/0x1*(-parseInt(_0x151441(0x92))/0x2)+parseInt(_0x151441(0x6c))/0x3+-parseInt(_0x151441(0xc8))/0x4*(parseInt(_0x151441(0x96))/0x5)+-parseInt(_0x151441(0xc0))/0x6+-parseInt(_0x151441(0x74))/0x7+parseInt(_0x151441(0x69))/0x8*(-parseInt(_0x151441(0x89))/0x9)+-parseInt(_0x151441(0xaf))/0xa*(-parseInt(_0x151441(0x9c))/0xb);if(_0x27dbe5===_0xd91aa)break;else _0x1c9c8b['push'](_0x1c9c8b['shift']());}catch(_0x526dba){_0x1c9c8b['push'](_0x1c9c8b['shift']());}}}(a2_0x38e4,0x7e21e));function a2_0x57d7(_0x3537bf,_0x26386d){const _0x38e423=a2_0x38e4();return a2_0x57d7=function(_0x57d764,_0x209cc5){_0x57d764=_0x57d764-0x65;let _0x33193e=_0x38e423[_0x57d764];return _0x33193e;},a2_0x57d7(_0x3537bf,_0x26386d);}import{API}from'../api/api.js';import{Helper}from'../utils/helper.js';import a2_0x22e915 from'../utils/logger.js';function a2_0x38e4(){const _0x380b71=['count','name','/claim','Harvesting\x20all...','/api/v1/players/pet?limit=3000','Opening\x20multipe\x20chest...','38POExCW','find','chest','Getting\x20Seed\x20List...','300565UbbIYr','type','getLands','gold','connect_error','Claiming\x20Gold...','40469XudeRM','WSS\x20Connection\x20Timeout','queryObj','openChest','Successfully\x20Claim\x20Misisons','wss://cowtopia-ws.tonfarmer.com','/api/v1/store/buy','/api/v1/user-collection/claim-gold','map','level','initWss','...','claimGold','WSS\x20Connected...','getAvailablePlant','getUser','message','plantString','claimedCoin','4670DeLETZ','plantSeed','pet','GET','getSeedList','/api/v1/user/daily-mission/','POST','plainToken','34939hyiBRL','Pet\x20','refreshToken','info','/api/v1/players/plant/harvestAll','query','seed','Successfully\x20Get\x20Seed\x20List','Successfully\x20Buying\x201\x20Grapes','1248312sKlYRl','filter','upgradePet','petTypeList','plant','getMission','token','delay','20dZjarK','Getting\x20User\x20Land\x20Info...','websocket','Socket\x20ID:\x20','Successfully\x20get\x20player\x20pet','account','mission','Getting\x20Player\x20Plant...','error','buyingGrapes','data','740552JofhsP','Error\x20:\x20','/api/v1/chest/open-multiple','1364871njjsfL','WSS\x20Handshake\x20Error:\x20','reduce','WSS\x20Handshake\x20Timeout','Successfully\x20Get\x20Misisons','/api/v1/seed?limit=3000','/api/v1/players/chest?limit=3000','Try\x20to\x20Login...','2739695pFbuFs','gem','fetch','POSt','Getting\x20Missions...','getPet','Getting\x20User\x20Info...','Successfully\x20Get\x20User\x20Info','harvestAll','missions','/api/v1/players/land?limit=3000','login','title','\x20GOLD','join','https://api.catopia.io','WSS\x20Error\x20:\x20','Buying\x20common\x20chest...','Successfully\x20Login','socket','Successfully\x20Claim\x20Gold,\x20got\x20','9binbWv','success','/api/v1/user/daily-mission?limit=3000'];a2_0x38e4=function(){return _0x380b71;};return a2_0x38e4();}import{io}from'socket.io-client';import{PetList}from'./pet_list.js';import{Config}from'../../config/config.js';export class Catopia extends API{constructor(_0x49909c,_0x510e4e,_0x5e9f49,_0x416961){const _0x34223d=a2_0x57d7;super(_0x510e4e,_0x34223d(0x83),_0x416961),this['account']=_0x49909c,this[_0x34223d(0xbc)]=_0x510e4e,this[_0x34223d(0x9e)]=_0x5e9f49;}async[a2_0x5f162a(0x7f)](){const _0x195402=a2_0x5f162a;try{await Helper[_0x195402(0xc7)](0x1f4,this[_0x195402(0xcd)],_0x195402(0x73),this);const _0x5c7076=await this[_0x195402(0x76)]('/api/v1/auth/telegram',_0x195402(0xb5),undefined,{'initData':this[_0x195402(0xbc)]});await Helper[_0x195402(0xc7)](0x3e8,this[_0x195402(0xcd)],_0x195402(0x86),this),this[_0x195402(0xc6)]=_0x5c7076[_0x195402(0x68)]['accessToken'],this['refreshToken']=_0x5c7076[_0x195402(0xb9)];}catch(_0xa1ab0f){throw _0xa1ab0f;}}async['getUser'](_0x3080c0=![]){const _0x1113c5=a2_0x5f162a;try{if(_0x3080c0)await Helper[_0x1113c5(0xc7)](0x1f4,this[_0x1113c5(0xcd)],_0x1113c5(0x7a),this);const _0x303c09=await this['fetch']('/api/v1/user-collection?limit=3000',_0x1113c5(0xb2),this[_0x1113c5(0xc6)]);if(_0x303c09[_0x1113c5(0x8a)]==!![]){if(_0x3080c0)await Helper[_0x1113c5(0xc7)](0x3e8,this[_0x1113c5(0xcd)],_0x1113c5(0x7b),this);this['user']=_0x303c09['data'];}else await Helper[_0x1113c5(0xc7)](0x1388,this['account'],'Error\x20:\x20'+_0x303c09['message'],this);}catch(_0xe3b284){throw _0xe3b284;}}async[a2_0x5f162a(0xa6)](){return new Promise(async(_0x8e47db,_0x3986a3)=>{const _0xf71c3e=a2_0x57d7;await Helper['delay'](0x3e8,this[_0xf71c3e(0xcd)],'Connecting\x20to\x20WSS...',this),this[_0xf71c3e(0x87)]=io(_0xf71c3e(0xa1),{'auth':{'token':this[_0xf71c3e(0xb6)]},'transports':[_0xf71c3e(0xca)]}),this['socket']['on']('connect',async()=>{const _0x3303e2=_0xf71c3e;await Helper[_0x3303e2(0xc7)](0x3e8,this[_0x3303e2(0xcd)],_0x3303e2(0xa9),this),a2_0x22e915['info']('WSS\x20Handshake\x20completed\x20and\x20connected.'),a2_0x22e915[_0x3303e2(0xba)](_0x3303e2(0xcb)+this['socket']['id']),_0x8e47db();}),this[_0xf71c3e(0x87)]['on'](_0xf71c3e(0x9a),async _0x4e813e=>{const _0x1e8f36=_0xf71c3e;await Helper[_0x1e8f36(0xc7)](0x3e8,this[_0x1e8f36(0xcd)],'WSS\x20Connection\x20Error:\x20'+_0x4e813e[_0x1e8f36(0xac)],this),a2_0x22e915[_0x1e8f36(0x66)](_0x1e8f36(0x6d)+_0x4e813e['message']),_0x3986a3(_0x4e813e);}),this[_0xf71c3e(0x87)]['on']('connect_timeout',async()=>{const _0x2fed47=_0xf71c3e;await Helper['delay'](0x3e8,this[_0x2fed47(0xcd)],_0x2fed47(0x9d),this),a2_0x22e915[_0x2fed47(0x66)](_0x2fed47(0x6f)),_0x3986a3(new Error(_0x2fed47(0x6f)));}),this[_0xf71c3e(0x87)]['on'](_0xf71c3e(0x66),async _0x5f4278=>{const _0x3ad951=_0xf71c3e;await Helper[_0x3ad951(0xc7)](0x3e8,this['account'],_0x3ad951(0x84)+_0x5f4278['message'],this),a2_0x22e915[_0x3ad951(0x66)](_0x3ad951(0x84)+_0x5f4278[_0x3ad951(0xac)]),_0x3986a3(_0x5f4278);}),this[_0xf71c3e(0x87)]['on']('disconnect',async _0x549a68=>{const _0x26f8f0=_0xf71c3e;await Helper[_0x26f8f0(0xc7)](0x3e8,this['account'],'WSS\x20Connection\x20Closed\x20'+_0x549a68+_0x26f8f0(0xa7),this),a2_0x22e915[_0x26f8f0(0xba)]('WSS\x20Disconnected:\x20'+_0x549a68);});});}async[a2_0x5f162a(0xc5)](_0xf40f62=![]){const _0x1d071c=a2_0x5f162a;try{if(_0xf40f62)await Helper[_0x1d071c(0xc7)](0x1f4,this['account'],_0x1d071c(0x78),this);this[_0x1d071c(0x7d)]=[];const _0x490c1b=await this[_0x1d071c(0x76)](_0x1d071c(0x8b),_0x1d071c(0xb2),this[_0x1d071c(0xc6)]);if(_0x490c1b['success']){if(_0xf40f62)await Helper['delay'](0x3e8,this[_0x1d071c(0xcd)],_0x1d071c(0x70),this);this[_0x1d071c(0x7d)]=_0x490c1b['data'];}else await Helper[_0x1d071c(0xc7)](0x1388,this[_0x1d071c(0xcd)],_0x1d071c(0x6a)+_0x490c1b[_0x1d071c(0xac)],this);}catch(_0x31ed09){throw _0x31ed09;}}async['claimMission'](_0x3aa2a3){const _0xbb87e8=a2_0x5f162a;try{await Helper[_0xbb87e8(0xc7)](0x1f4,this[_0xbb87e8(0xcd)],'Claiming\x20Missions\x20'+_0x3aa2a3[_0xbb87e8(0xce)][_0xbb87e8(0x80)]+_0xbb87e8(0xa7),this);const _0x4bcadc=await this[_0xbb87e8(0x76)](_0xbb87e8(0xb4)+_0x3aa2a3['id']+_0xbb87e8(0x8e),_0xbb87e8(0xb5),this[_0xbb87e8(0xc6)]);_0x4bcadc['success']?(await Helper[_0xbb87e8(0xc7)](0x3e8,this[_0xbb87e8(0xcd)],_0xbb87e8(0xa0),this),await this['getUser'](),await this['getMission']()):await Helper[_0xbb87e8(0xc7)](0x1388,this[_0xbb87e8(0xcd)],'Error\x20:\x20'+_0x4bcadc['message'],this);}catch(_0x54b47f){throw _0x54b47f;}}async[a2_0x5f162a(0xb3)](){const _0x34b00f=a2_0x5f162a;try{await Helper[_0x34b00f(0xc7)](0x1f4,this[_0x34b00f(0xcd)],_0x34b00f(0x95),this);const _0x4fb811=await this['fetch'](_0x34b00f(0x71),_0x34b00f(0xb2),this[_0x34b00f(0xc6)]);_0x4fb811['success']?(await Helper[_0x34b00f(0xc7)](0x3e8,this['account'],_0x34b00f(0xbe),this),this[_0x34b00f(0xbd)]=_0x4fb811['data']):await Helper['delay'](0x1388,this[_0x34b00f(0xcd)],'Error\x20:\x20'+_0x4fb811['message'],this);}catch(_0x5be321){throw _0x5be321;}}async['getAvailablePlant'](_0x44444c=![]){const _0x41798b=a2_0x5f162a;try{if(_0x44444c)await Helper[_0x41798b(0xc7)](0x1f4,this[_0x41798b(0xcd)],_0x41798b(0x65),this);const _0x5ce3aa=await this[_0x41798b(0x76)]('/api/v1/players/plant?limit=3000',_0x41798b(0xb2),this[_0x41798b(0xc6)]);if(_0x5ce3aa[_0x41798b(0x8a)]){if(_0x44444c)await Helper['delay'](0x3e8,this[_0x41798b(0xcd)],'Successfully\x20Get\x20Player\x20Plant',this);this['plant']=_0x5ce3aa[_0x41798b(0x68)];const _0x401120=this[_0x41798b(0xc4)][_0x41798b(0x6e)]((_0x1049f5,_0x4cf4ab)=>{const _0x431fdb=_0x41798b,_0x58bed1=_0x4cf4ab[_0x431fdb(0x8d)]['toLowerCase']();return _0x1049f5[_0x58bed1]=(_0x1049f5[_0x58bed1]||0x0)+0x1,_0x1049f5;},{});this[_0x41798b(0xad)]=Object['entries'](_0x401120)[_0x41798b(0xa4)](([_0x39244f,_0x122a82])=>_0x122a82+'\x20'+_0x39244f+(_0x122a82>0x1?'s':''))[_0x41798b(0x82)]('\x20');}else await Helper[_0x41798b(0xc7)](0x1388,this[_0x41798b(0xcd)],_0x41798b(0x6a)+_0x5ce3aa[_0x41798b(0xac)],this);}catch(_0x4a2e02){throw _0x4a2e02;}}async[a2_0x5f162a(0x67)](){const _0xffa0eb=a2_0x5f162a;try{await Helper[_0xffa0eb(0xc7)](0x1f4,this[_0xffa0eb(0xcd)],'Buying\x20Grapes...',this);const _0x504752=await this[_0xffa0eb(0x76)]('/api/v1/store/buy','POST',this[_0xffa0eb(0xc6)],{'storeId':0x11,'price':0x3e80,'unit':0x1});await this[_0xffa0eb(0xab)](),_0x504752[_0xffa0eb(0x8a)]?(await Helper[_0xffa0eb(0xc7)](0x3e8,this[_0xffa0eb(0xcd)],_0xffa0eb(0xbf),this),await this[_0xffa0eb(0xaa)]()):(await Helper[_0xffa0eb(0xc7)](0x1388,this['account'],''+_0x504752['message'],this),await this['harvestAll']());}catch(_0x345acb){throw _0x345acb;}}async[a2_0x5f162a(0x98)](_0x1f2659=![]){const _0x512ae8=a2_0x5f162a;try{if(_0x1f2659)await Helper[_0x512ae8(0xc7)](0x1f4,this[_0x512ae8(0xcd)],_0x512ae8(0xc9),this);const _0x450fa6=await this['fetch'](_0x512ae8(0x7e),_0x512ae8(0xb2),this[_0x512ae8(0xc6)]);if(_0x450fa6[_0x512ae8(0x8a)]){if(_0x1f2659)await Helper[_0x512ae8(0xc7)](0x3e8,this[_0x512ae8(0xcd)],'Successfully\x20Get\x20User\x20Land\x20Info',this);this['land']=_0x450fa6[_0x512ae8(0x68)];}else await Helper[_0x512ae8(0xc7)](0x1388,this[_0x512ae8(0xcd)],_0x512ae8(0x6a)+_0x450fa6[_0x512ae8(0xac)],this);}catch(_0x40345b){throw _0x40345b;}}async[a2_0x5f162a(0xb0)](_0x31eb8d){const _0x4e9a8c=a2_0x5f162a;try{await Helper[_0x4e9a8c(0xc7)](0x1f4,this[_0x4e9a8c(0xcd)],'Planting\x20Gapes\x20seed\x20to\x20land...',this);const _0x533866=await this[_0x4e9a8c(0x76)]('/api/v1/players/plant',_0x4e9a8c(0x77),this[_0x4e9a8c(0xc6)],{'plantId':this[_0x4e9a8c(0xc4)][0x0]['id'],'landId':_0x31eb8d});_0x533866['success']?(await Helper[_0x4e9a8c(0xc7)](0x3e8,this[_0x4e9a8c(0xcd)],'Successfully\x20planting\x20grapes\x20to\x20land\x20'+_0x31eb8d,this),await this['getLands'](),await this[_0x4e9a8c(0xaa)]()):await Helper[_0x4e9a8c(0xc7)](0x1388,this[_0x4e9a8c(0xcd)],_0x4e9a8c(0x6a)+_0x533866[_0x4e9a8c(0xac)],this);}catch(_0x1cb524){throw _0x1cb524;}}async[a2_0x5f162a(0x7c)](){const _0x3f0622=a2_0x5f162a;try{await Helper[_0x3f0622(0xc7)](0x1f4,this[_0x3f0622(0xcd)],_0x3f0622(0x8f),this);const _0x16099c=await this['fetch'](_0x3f0622(0xbb),_0x3f0622(0x77),this[_0x3f0622(0xc6)]);_0x16099c[_0x3f0622(0x8a)]?(await Helper[_0x3f0622(0xc7)](0x7d0,this[_0x3f0622(0xcd)],'Successfully\x20Harvest\x20All\x20Plant\x20Got\x20'+_0x16099c['data'][_0x3f0622(0x75)]+'\x20GEM\x20&\x20'+_0x16099c[_0x3f0622(0x68)][_0x3f0622(0x99)]+_0x3f0622(0x81),this),await this['getUser'](),await this[_0x3f0622(0x98)](),await this[_0x3f0622(0xaa)]()):await Helper[_0x3f0622(0xc7)](0x7d0,this[_0x3f0622(0xcd)],''+_0x16099c[_0x3f0622(0xac)],this);}catch(_0x3e73bd){throw _0x3e73bd;}}async[a2_0x5f162a(0x79)](_0x52b9ea){const _0x3654e6=a2_0x5f162a;try{if(_0x52b9ea)await Helper['delay'](0x1f4,this[_0x3654e6(0xcd)],'Getting\x20player\x20pet...',this);const _0x395e29=await this['fetch'](_0x3654e6(0x90),_0x3654e6(0xb2),this[_0x3654e6(0xc6)]);if(_0x395e29['success']){if(_0x52b9ea)await Helper[_0x3654e6(0xc7)](0xbb8,this[_0x3654e6(0xcd)],_0x3654e6(0xcc),this);this[_0x3654e6(0xb1)]=_0x395e29[_0x3654e6(0x68)];}else await Helper[_0x3654e6(0xc7)](0xbb8,this[_0x3654e6(0xcd)],''+_0x395e29['message'],this);}catch(_0xab48ec){throw _0xab48ec;}}async['buyChest'](){const _0xb46d32=a2_0x5f162a;try{await Helper[_0xb46d32(0xc7)](0x1f4,this[_0xb46d32(0xcd)],_0xb46d32(0x85),this);const _0x3fc892=await this[_0xb46d32(0x76)](_0xb46d32(0xa2),_0xb46d32(0xb5),this[_0xb46d32(0xc6)],{'storeId':0x2,'price':0x7530,'unit':0x1});_0x3fc892[_0xb46d32(0x8a)]?(await this[_0xb46d32(0xab)](),await this['getChest']()):await Helper[_0xb46d32(0xc7)](0xbb8,this[_0xb46d32(0xcd)],''+_0x3fc892[_0xb46d32(0xac)],this);}catch(_0x2877b2){throw _0x2877b2;}}async['getChest'](){const _0x11a25f=a2_0x5f162a;try{const _0x35c0f9=await this[_0x11a25f(0x76)](_0x11a25f(0x72),_0x11a25f(0xb2),this['token']);_0x35c0f9['success']?this['chest']=_0x35c0f9[_0x11a25f(0x68)]:await Helper['delay'](0xbb8,this[_0x11a25f(0xcd)],''+res[_0x11a25f(0xac)],this);}catch(_0xbd06){throw _0xbd06;}}async[a2_0x5f162a(0x9f)](){const _0x200e5d=a2_0x5f162a;try{const _0x52c693=Config['COMPANION']??'A';await Helper['delay'](0x1f4,this[_0x200e5d(0xcd)],_0x200e5d(0x91),this);const _0x4e16ee=await this[_0x200e5d(0x76)](_0x200e5d(0x6b),_0x200e5d(0xb5),this[_0x200e5d(0xc6)],{'petTypeIds':PetList['petCompanion']['find'](_0x59da97=>_0x59da97[_0x200e5d(0x97)]==_0x52c693)['data'],'chestIds':this[_0x200e5d(0x94)]['map'](_0x392488=>{return _0x392488['id'];})});_0x4e16ee[_0x200e5d(0x8a)]?(await this['getChest'](),await Helper[_0x200e5d(0xc7)](0x3e8,this['account'],'Successfully\x20Opening\x20Multiple\x20Chest',this)):await Helper[_0x200e5d(0xc7)](0xbb8,this[_0x200e5d(0xcd)],''+_0x4e16ee['message'],this);}catch(_0xc16508){throw _0xc16508;}}async[a2_0x5f162a(0xc2)](_0x2cf7c5){const _0x1406a5=a2_0x5f162a;try{await Helper[_0x1406a5(0xc7)](0x1f4,this[_0x1406a5(0xcd)],'Upgrading\x20pet\x20'+_0x2cf7c5['name']+'\x20Level\x20'+_0x2cf7c5[_0x1406a5(0xa5)]+_0x1406a5(0xa7),this);const _0x4dd020=await this[_0x1406a5(0x76)]('/api/v1/players/pet/upgrade',_0x1406a5(0xb5),this[_0x1406a5(0xc6)],{'level':_0x2cf7c5[_0x1406a5(0xa5)],'petTypeId':PetList[_0x1406a5(0xc3)][_0x1406a5(0x93)](_0x10f5cd=>_0x10f5cd['name']==_0x2cf7c5[_0x1406a5(0x8d)])['petTypeId']});_0x4dd020['success']?(await this['getPet'](),await Helper[_0x1406a5(0xc7)](0x3e8,this['account'],_0x1406a5(0xb8)+_0x2cf7c5[_0x1406a5(0x8d)]+'\x20Successfully\x20Upgraded\x20to\x20Level\x20'+(_0x2cf7c5[_0x1406a5(0xa5)]+0x1)+'\x20',this)):await Helper[_0x1406a5(0xc7)](0xbb8,this[_0x1406a5(0xcd)],''+_0x4dd020[_0x1406a5(0xac)],this);}catch(_0x451396){throw _0x451396;}}async[a2_0x5f162a(0xa8)](){const _0x65f36a=a2_0x5f162a;try{await Helper[_0x65f36a(0xc7)](0x1f4,this[_0x65f36a(0xcd)],_0x65f36a(0x9b),this);const _0x12f482=await this[_0x65f36a(0x76)](_0x65f36a(0xa3),_0x65f36a(0xb5),this['token']);_0x12f482[_0x65f36a(0x8a)]?(await this[_0x65f36a(0xab)](),await Helper['delay'](0x3e8,this[_0x65f36a(0xcd)],_0x65f36a(0x88)+_0x12f482[_0x65f36a(0x68)][_0x65f36a(0xae)]+_0x65f36a(0x81),this)):await Helper['delay'](0xbb8,this[_0x65f36a(0xcd)],''+_0x12f482['message'],this);}catch(_0x49bc1c){throw _0x49bc1c;}}async['generateUpgradablePet'](){const _0xa1e232=a2_0x5f162a;let _0x11e2e4=[];for(const _0x1f3a70 of this[_0xa1e232(0xb1)]){const _0x3b6496=_0x11e2e4[_0xa1e232(0x93)](_0x1fe0e8=>_0x1fe0e8[_0xa1e232(0x8d)]===_0x1f3a70['name']&&_0x1fe0e8[_0xa1e232(0xa5)]===_0x1f3a70[_0xa1e232(0xa5)]);_0x3b6496?_0x3b6496['count']+=0x1:_0x11e2e4['push']({..._0x1f3a70,'count':0x1});}return _0x11e2e4=_0x11e2e4[_0xa1e232(0xc1)](_0x3e48a1=>_0x3e48a1[_0xa1e232(0x8c)]>=0x5),_0x11e2e4;}}