const a2_0x299691=a2_0x4d24;(function(_0x4972d6,_0x1bc62c){const _0x3fbbed=a2_0x4d24,_0xd71d41=_0x4972d6();while(!![]){try{const _0x5e4f2d=parseInt(_0x3fbbed(0x240))/0x1+parseInt(_0x3fbbed(0x205))/0x2+-parseInt(_0x3fbbed(0x1f4))/0x3*(parseInt(_0x3fbbed(0x1f8))/0x4)+parseInt(_0x3fbbed(0x1e0))/0x5+-parseInt(_0x3fbbed(0x21b))/0x6*(parseInt(_0x3fbbed(0x22f))/0x7)+-parseInt(_0x3fbbed(0x213))/0x8*(-parseInt(_0x3fbbed(0x1fc))/0x9)+-parseInt(_0x3fbbed(0x1df))/0xa;if(_0x5e4f2d===_0x1bc62c)break;else _0xd71d41['push'](_0xd71d41['shift']());}catch(_0x2b766f){_0xd71d41['push'](_0xd71d41['shift']());}}}(a2_0x20a3,0x7a7c0));import{API}from'../api/api.js';import{Helper}from'../utils/helper.js';function a2_0x20a3(){const _0x2f7cdb=['/api/v1/user-collection?limit=3000','pet','Getting\x20User\x20Land\x20Info...','seed','Successfully\x20Get\x20Misisons','Pet\x20','type','\x20Level\x20','/api/v1/players/chest?limit=3000','count','Getting\x20Player\x20Plant...','Successfully\x20Get\x20Player\x20Plant','success','wss://cowtopia-ws.tonfarmer.com','/api/v1/auth/telegram','claimedCoin','Successfully\x20Claim\x20Gold,\x20got\x20','Upgrading\x20pet\x20','28ltQszy','upgradePet','fetch','reduce','COMPANION','join','POSt','petTypeId','/api/v1/players/pet?limit=3000','Successfully\x20Opening\x20Multiple\x20Chest','error','token','accessToken','getPet','Successfully\x20Get\x20User\x20Info','map','Successfully\x20Login','494289aqJTNg','socket','/api/v1/players/pet/upgrade','GET','plantSeed','info','claimGold','POST','connect_timeout','\x20GEM\x20&\x20','13311300PqoDkY','1553000zXtVBY','title','buyingGrapes','openChest','message','/api/v1/user/daily-mission?limit=3000','Getting\x20Missions...','connect_error','claimMission','WSS\x20Disconnected:\x20','Connecting\x20to\x20WSS...','plantString','getMission','getAvailablePlant','https://api.catopia.io','WSS\x20Error\x20:\x20','Try\x20to\x20Login...','account','push','find','33BPixrW','land','getUser','query','80840ffRFOp','harvestAll','getLands','level','126yJFBxS','\x20Grapes','plant','/claim','\x20GOLD','typeId','/api/v1/players/land?limit=3000','websocket','...','1537078XSIsxf','getChest','Successfully\x20Get\x20Seed\x20List','getSeedList','Error\x20:\x20','Buying\x20Grapes...','refreshToken','chest','WSS\x20Connection\x20Timeout','WSS\x20Connection\x20Error:\x20','petTypeList','gold','name','delay','398080WqLMgs','/api/v1/seed?limit=3000','Getting\x20Seed\x20List...','/api/v1/store/buy','WSS\x20Handshake\x20Error:\x20','buyChest','Buying\x20common\x20chest...','data','322398umabFE','filter'];a2_0x20a3=function(){return _0x2f7cdb;};return a2_0x20a3();}import a2_0x179072 from'../utils/logger.js';import{io}from'socket.io-client';import{PetList}from'./pet_list.js';function a2_0x4d24(_0x3ef180,_0x142f06){const _0x20a321=a2_0x20a3();return a2_0x4d24=function(_0x4d24fd,_0x43810a){_0x4d24fd=_0x4d24fd-0x1d9;let _0x46522a=_0x20a321[_0x4d24fd];return _0x46522a;},a2_0x4d24(_0x3ef180,_0x142f06);}import{Config}from'../../config/config.js';export class Catopia extends API{constructor(_0xd53d3c,_0x5acbd6,_0x1205a8,_0x2b07f0){const _0x25d658=a2_0x4d24;super(_0x5acbd6,_0x25d658(0x1ee),_0x2b07f0),this[_0x25d658(0x1f1)]=_0xd53d3c,this['query']=_0x5acbd6,this['queryObj']=_0x1205a8;}async['login'](){const _0x15bd0e=a2_0x4d24;try{await Helper[_0x15bd0e(0x212)](0x1f4,this['account'],_0x15bd0e(0x1f0),this);const _0x5d2c40=await this[_0x15bd0e(0x231)](_0x15bd0e(0x22b),_0x15bd0e(0x1dc),undefined,{'initData':this[_0x15bd0e(0x1f7)]});await Helper[_0x15bd0e(0x212)](0x3e8,this['account'],_0x15bd0e(0x23f),this),this[_0x15bd0e(0x23a)]=_0x5d2c40['data'][_0x15bd0e(0x23b)],this[_0x15bd0e(0x20b)]=_0x5d2c40[_0x15bd0e(0x20b)];}catch(_0x1f875c){throw _0x1f875c;}}async[a2_0x299691(0x1f6)](_0x5a9784=![]){const _0x2c326e=a2_0x299691;try{if(_0x5a9784)await Helper[_0x2c326e(0x212)](0x1f4,this[_0x2c326e(0x1f1)],'Getting\x20User\x20Info...',this);const _0x223e2c=await this['fetch'](_0x2c326e(0x21d),_0x2c326e(0x243),this['token']);if(_0x223e2c['success']==!![]){if(_0x5a9784)await Helper[_0x2c326e(0x212)](0x3e8,this[_0x2c326e(0x1f1)],_0x2c326e(0x23d),this);this['user']=_0x223e2c['data'];}else await Helper[_0x2c326e(0x212)](0x1388,this['account'],_0x2c326e(0x209)+_0x223e2c['message'],this);}catch(_0x53222c){throw _0x53222c;}}async['initWss'](){return new Promise(async(_0x1ada12,_0x258456)=>{const _0x1974fb=a2_0x4d24;await Helper['delay'](0x3e8,this[_0x1974fb(0x1f1)],_0x1974fb(0x1ea),this),this[_0x1974fb(0x241)]=io(_0x1974fb(0x22a),{'auth':{'token':this['plainToken']},'transports':[_0x1974fb(0x203)]}),this[_0x1974fb(0x241)]['on']('connect',async()=>{const _0x576a2a=_0x1974fb;await Helper['delay'](0x3e8,this[_0x576a2a(0x1f1)],'WSS\x20Connected...',this),a2_0x179072[_0x576a2a(0x1da)]('WSS\x20Handshake\x20completed\x20and\x20connected.'),a2_0x179072['info']('Socket\x20ID:\x20'+this[_0x576a2a(0x241)]['id']),_0x1ada12();}),this[_0x1974fb(0x241)]['on'](_0x1974fb(0x1e7),async _0x8c2a96=>{const _0x58571c=_0x1974fb;await Helper[_0x58571c(0x212)](0x3e8,this[_0x58571c(0x1f1)],_0x58571c(0x20e)+_0x8c2a96[_0x58571c(0x1e4)],this),a2_0x179072[_0x58571c(0x239)](_0x58571c(0x217)+_0x8c2a96[_0x58571c(0x1e4)]),_0x258456(_0x8c2a96);}),this[_0x1974fb(0x241)]['on'](_0x1974fb(0x1dd),async()=>{const _0x5dd62c=_0x1974fb;await Helper['delay'](0x3e8,this[_0x5dd62c(0x1f1)],_0x5dd62c(0x20d),this),a2_0x179072[_0x5dd62c(0x239)]('WSS\x20Handshake\x20Timeout'),_0x258456(new Error('WSS\x20Handshake\x20Timeout'));}),this[_0x1974fb(0x241)]['on']('error',async _0x86ca30=>{const _0xe62ff9=_0x1974fb;await Helper[_0xe62ff9(0x212)](0x3e8,this[_0xe62ff9(0x1f1)],_0xe62ff9(0x1ef)+_0x86ca30[_0xe62ff9(0x1e4)],this),a2_0x179072[_0xe62ff9(0x239)]('WSS\x20Error\x20:\x20'+_0x86ca30['message']),_0x258456(_0x86ca30);}),this[_0x1974fb(0x241)]['on']('disconnect',async _0x310fcf=>{const _0x1684bf=_0x1974fb;await Helper[_0x1684bf(0x212)](0x3e8,this[_0x1684bf(0x1f1)],'WSS\x20Connection\x20Closed\x20'+_0x310fcf+_0x1684bf(0x204),this),a2_0x179072[_0x1684bf(0x1da)](_0x1684bf(0x1e9)+_0x310fcf);});});}async[a2_0x299691(0x1ec)](_0x20d7e6=![]){const _0x5c6c96=a2_0x299691;try{if(_0x20d7e6)await Helper[_0x5c6c96(0x212)](0x1f4,this[_0x5c6c96(0x1f1)],_0x5c6c96(0x1e6),this);this['missions']=[];const _0x233a73=await this[_0x5c6c96(0x231)](_0x5c6c96(0x1e5),_0x5c6c96(0x243),this['token']);if(_0x233a73[_0x5c6c96(0x229)]){if(_0x20d7e6)await Helper[_0x5c6c96(0x212)](0x3e8,this[_0x5c6c96(0x1f1)],_0x5c6c96(0x221),this);this['missions']=_0x233a73[_0x5c6c96(0x21a)];}else await Helper[_0x5c6c96(0x212)](0x1388,this[_0x5c6c96(0x1f1)],_0x5c6c96(0x209)+_0x233a73[_0x5c6c96(0x1e4)],this);}catch(_0x1fd0cc){throw _0x1fd0cc;}}async[a2_0x299691(0x1e8)](_0x16f128){const _0x352649=a2_0x299691;try{await Helper[_0x352649(0x212)](0x1f4,this[_0x352649(0x1f1)],'Claiming\x20Missions\x20'+_0x16f128['mission'][_0x352649(0x1e1)]+_0x352649(0x204),this);const _0x5e30a1=await this[_0x352649(0x231)]('/api/v1/user/daily-mission/'+_0x16f128['id']+_0x352649(0x1ff),_0x352649(0x1dc),this[_0x352649(0x23a)]);_0x5e30a1['success']?(await Helper[_0x352649(0x212)](0x3e8,this['account'],'Successfully\x20Claim\x20Misisons',this),await this[_0x352649(0x1f6)](),await this[_0x352649(0x1ec)]()):await Helper[_0x352649(0x212)](0x1388,this[_0x352649(0x1f1)],'Error\x20:\x20'+_0x5e30a1[_0x352649(0x1e4)],this);}catch(_0x46efd5){throw _0x46efd5;}}async[a2_0x299691(0x208)](){const _0x4e4409=a2_0x299691;try{await Helper[_0x4e4409(0x212)](0x1f4,this['account'],_0x4e4409(0x215),this);const _0x506cc5=await this['fetch'](_0x4e4409(0x214),'GET',this[_0x4e4409(0x23a)]);_0x506cc5[_0x4e4409(0x229)]?(await Helper[_0x4e4409(0x212)](0x3e8,this[_0x4e4409(0x1f1)],_0x4e4409(0x207),this),this[_0x4e4409(0x220)]=_0x506cc5[_0x4e4409(0x21a)]):await Helper[_0x4e4409(0x212)](0x1388,this[_0x4e4409(0x1f1)],_0x4e4409(0x209)+_0x506cc5[_0x4e4409(0x1e4)],this);}catch(_0x1fa572){throw _0x1fa572;}}async['getAvailablePlant'](_0x2597a2=![]){const _0x5ad23c=a2_0x299691;try{if(_0x2597a2)await Helper[_0x5ad23c(0x212)](0x1f4,this['account'],_0x5ad23c(0x227),this);const _0x20cac4=await this[_0x5ad23c(0x231)]('/api/v1/players/plant?limit=3000','GET',this[_0x5ad23c(0x23a)]);if(_0x20cac4['success']){if(_0x2597a2)await Helper[_0x5ad23c(0x212)](0x3e8,this[_0x5ad23c(0x1f1)],_0x5ad23c(0x228),this);this[_0x5ad23c(0x1fe)]=_0x20cac4['data'];const _0x5643c6=this['plant'][_0x5ad23c(0x232)]((_0x5a8967,_0x1451ea)=>{const _0x437892=_0x5ad23c,_0x283def=_0x1451ea[_0x437892(0x211)];return _0x5a8967[_0x283def]=(_0x5a8967[_0x283def]||0x0)+0x1,_0x5a8967;},{});this['plantString']=Object['entries'](_0x5643c6)[_0x5ad23c(0x23e)](([_0x2b2de1,_0x1ca012])=>_0x1ca012+_0x5ad23c(0x1fd))[_0x5ad23c(0x234)]('\x20'),(this[_0x5ad23c(0x1eb)]==''||this[_0x5ad23c(0x1eb)]==undefined)&&(this[_0x5ad23c(0x1eb)]='0\x20Grapes');}else await Helper[_0x5ad23c(0x212)](0x1388,this[_0x5ad23c(0x1f1)],'Error\x20:\x20'+_0x20cac4[_0x5ad23c(0x1e4)],this);}catch(_0x385500){throw _0x385500;}}async[a2_0x299691(0x1e2)](){const _0x5a998b=a2_0x299691;try{await Helper['delay'](0x1f4,this[_0x5a998b(0x1f1)],_0x5a998b(0x20a),this);const _0x3cabc1=await this[_0x5a998b(0x231)](_0x5a998b(0x216),'POST',this['token'],{'storeId':0x11,'price':0x3e80,'unit':0x1});await this[_0x5a998b(0x1f6)](),_0x3cabc1[_0x5a998b(0x229)]?(await Helper[_0x5a998b(0x212)](0x3e8,this[_0x5a998b(0x1f1)],'Successfully\x20Buying\x201\x20Grapes',this),await this[_0x5a998b(0x1ed)]()):(await Helper['delay'](0x1388,this[_0x5a998b(0x1f1)],''+_0x3cabc1[_0x5a998b(0x1e4)],this),await this[_0x5a998b(0x1f9)]());}catch(_0x246422){throw _0x246422;}}async[a2_0x299691(0x1fa)](_0x5aa29b=![]){const _0x2826f7=a2_0x299691;try{if(_0x5aa29b)await Helper['delay'](0x1f4,this[_0x2826f7(0x1f1)],_0x2826f7(0x21f),this);const _0x5d2f8d=await this[_0x2826f7(0x231)](_0x2826f7(0x202),'GET',this[_0x2826f7(0x23a)]);if(_0x5d2f8d[_0x2826f7(0x229)]){if(_0x5aa29b)await Helper[_0x2826f7(0x212)](0x3e8,this[_0x2826f7(0x1f1)],'Successfully\x20Get\x20User\x20Land\x20Info',this);this[_0x2826f7(0x1f5)]=_0x5d2f8d[_0x2826f7(0x21a)];}else await Helper['delay'](0x1388,this[_0x2826f7(0x1f1)],_0x2826f7(0x209)+_0x5d2f8d[_0x2826f7(0x1e4)],this);}catch(_0x8459e4){throw _0x8459e4;}}async[a2_0x299691(0x1d9)](_0x540946){const _0x538f79=a2_0x299691;try{await Helper['delay'](0x1f4,this[_0x538f79(0x1f1)],'Planting\x20Gapes\x20seed\x20to\x20land...',this);const _0x475316=await this[_0x538f79(0x231)]('/api/v1/players/plant',_0x538f79(0x235),this['token'],{'plantId':this[_0x538f79(0x1fe)][0x0]['id'],'landId':_0x540946});_0x475316['success']?(await Helper[_0x538f79(0x212)](0x3e8,this['account'],'Successfully\x20planting\x20grapes\x20to\x20land\x20'+_0x540946,this),await this['getLands'](),await this['getAvailablePlant']()):await Helper[_0x538f79(0x212)](0x1388,this[_0x538f79(0x1f1)],'Error\x20:\x20'+_0x475316['message'],this);}catch(_0x551b39){throw _0x551b39;}}async[a2_0x299691(0x1f9)](){const _0xbf7829=a2_0x299691;try{await Helper[_0xbf7829(0x212)](0x1f4,this['account'],'Harvesting\x20all...',this);const _0x30fdc0=await this[_0xbf7829(0x231)]('/api/v1/players/plant/harvestAll',_0xbf7829(0x235),this['token']);_0x30fdc0[_0xbf7829(0x229)]?(await Helper[_0xbf7829(0x212)](0x7d0,this[_0xbf7829(0x1f1)],'Successfully\x20Harvest\x20All\x20Plant\x20Got\x20'+_0x30fdc0[_0xbf7829(0x21a)]['gem']+_0xbf7829(0x1de)+_0x30fdc0[_0xbf7829(0x21a)][_0xbf7829(0x210)]+_0xbf7829(0x200),this),await this[_0xbf7829(0x1f6)](),await this['getLands'](),await this[_0xbf7829(0x1ed)]()):await Helper[_0xbf7829(0x212)](0x7d0,this[_0xbf7829(0x1f1)],''+_0x30fdc0['message'],this);}catch(_0x247add){throw _0x247add;}}async[a2_0x299691(0x23c)](_0x41b184){const _0x21b60b=a2_0x299691;try{if(_0x41b184)await Helper[_0x21b60b(0x212)](0x1f4,this['account'],'Getting\x20player\x20pet...',this);const _0x2e5ddd=await this[_0x21b60b(0x231)](_0x21b60b(0x237),_0x21b60b(0x243),this[_0x21b60b(0x23a)]);if(_0x2e5ddd[_0x21b60b(0x229)]){if(_0x41b184)await Helper[_0x21b60b(0x212)](0xbb8,this[_0x21b60b(0x1f1)],'Successfully\x20get\x20player\x20pet',this);this[_0x21b60b(0x21e)]=_0x2e5ddd[_0x21b60b(0x21a)];}else await Helper[_0x21b60b(0x212)](0xbb8,this[_0x21b60b(0x1f1)],''+_0x2e5ddd[_0x21b60b(0x1e4)],this);}catch(_0x1f3bdb){throw _0x1f3bdb;}}async[a2_0x299691(0x218)](){const _0x329f49=a2_0x299691;try{await Helper['delay'](0x1f4,this[_0x329f49(0x1f1)],_0x329f49(0x219),this);const _0x1e1710=await this[_0x329f49(0x231)](_0x329f49(0x216),'POST',this[_0x329f49(0x23a)],{'storeId':0x2,'price':0x7530,'unit':0x1});_0x1e1710[_0x329f49(0x229)]?(await this[_0x329f49(0x1f6)](),await this[_0x329f49(0x206)]()):await Helper[_0x329f49(0x212)](0xbb8,this[_0x329f49(0x1f1)],''+_0x1e1710[_0x329f49(0x1e4)],this);}catch(_0x280c63){throw _0x280c63;}}async[a2_0x299691(0x206)](){const _0x35bb48=a2_0x299691;try{const _0x4d5513=await this[_0x35bb48(0x231)](_0x35bb48(0x225),_0x35bb48(0x243),this[_0x35bb48(0x23a)]);_0x4d5513[_0x35bb48(0x229)]?this['chest']=_0x4d5513[_0x35bb48(0x21a)]:await Helper[_0x35bb48(0x212)](0xbb8,this[_0x35bb48(0x1f1)],''+res[_0x35bb48(0x1e4)],this);}catch(_0x2e63f0){throw _0x2e63f0;}}async[a2_0x299691(0x1e3)](){const _0x3c7fe6=a2_0x299691;try{const _0x331cbe=Config[_0x3c7fe6(0x233)]??'A';await Helper[_0x3c7fe6(0x212)](0x1f4,this[_0x3c7fe6(0x1f1)],'Opening\x20multipe\x20chest...',this);const _0x548872=await this[_0x3c7fe6(0x231)]('/api/v1/chest/open-multiple',_0x3c7fe6(0x1dc),this[_0x3c7fe6(0x23a)],{'petTypeIds':PetList['petCompanion'][_0x3c7fe6(0x1f3)](_0x43c332=>_0x43c332[_0x3c7fe6(0x223)]==_0x331cbe)[_0x3c7fe6(0x21a)],'chestIds':this[_0x3c7fe6(0x20c)][_0x3c7fe6(0x23e)](_0x3c291a=>{return _0x3c291a['id'];})});_0x548872[_0x3c7fe6(0x229)]?(await this['getChest'](),await Helper[_0x3c7fe6(0x212)](0x3e8,this['account'],_0x3c7fe6(0x238),this)):await Helper['delay'](0xbb8,this[_0x3c7fe6(0x1f1)],''+_0x548872[_0x3c7fe6(0x1e4)],this);}catch(_0x4465ef){throw _0x4465ef;}}async[a2_0x299691(0x230)](_0x26ef52){const _0x965e9c=a2_0x299691;try{await Helper[_0x965e9c(0x212)](0x1f4,this[_0x965e9c(0x1f1)],_0x965e9c(0x22e)+_0x26ef52['typeId']+_0x965e9c(0x224)+_0x26ef52[_0x965e9c(0x1fb)]+'...',this);const _0x321755=PetList[_0x965e9c(0x20f)][_0x965e9c(0x1f3)](_0x128342=>_0x128342[_0x965e9c(0x236)]==_0x26ef52['typeId']),_0xff66f7=await this[_0x965e9c(0x231)](_0x965e9c(0x242),_0x965e9c(0x1dc),this[_0x965e9c(0x23a)],{'level':_0x26ef52[_0x965e9c(0x1fb)],'petTypeId':_0x321755[_0x965e9c(0x236)]});_0xff66f7['success']?(await this[_0x965e9c(0x23c)](),await Helper[_0x965e9c(0x212)](0x3e8,this[_0x965e9c(0x1f1)],_0x965e9c(0x222)+_0x26ef52[_0x965e9c(0x201)]+'\x20Successfully\x20Upgraded\x20to\x20Level\x20'+(_0x26ef52[_0x965e9c(0x1fb)]+0x1)+'\x20',this)):await Helper['delay'](0xbb8,this['account'],''+_0xff66f7[_0x965e9c(0x1e4)],this);}catch(_0x4a4c24){throw _0x4a4c24;}}async[a2_0x299691(0x1db)](){const _0x4cabcd=a2_0x299691;try{await Helper['delay'](0x1f4,this['account'],'Claiming\x20Gold...',this);const _0x2cb8c2=await this[_0x4cabcd(0x231)]('/api/v1/user-collection/claim-gold',_0x4cabcd(0x1dc),this[_0x4cabcd(0x23a)]);_0x2cb8c2['success']?(await this['getUser'](),await Helper[_0x4cabcd(0x212)](0x3e8,this[_0x4cabcd(0x1f1)],_0x4cabcd(0x22d)+_0x2cb8c2['data'][_0x4cabcd(0x22c)]+'\x20GOLD',this)):await Helper[_0x4cabcd(0x212)](0xbb8,this['account'],''+_0x2cb8c2[_0x4cabcd(0x1e4)],this);}catch(_0x317575){throw _0x317575;}}async['generateUpgradablePet'](){const _0x40aeb8=a2_0x299691;let _0x36b5b6=[];for(const _0x54dcb4 of this[_0x40aeb8(0x21e)]){const _0x53415d=_0x36b5b6['find'](_0x1eee17=>_0x1eee17[_0x40aeb8(0x201)]===_0x54dcb4[_0x40aeb8(0x201)]&&_0x1eee17['level']===_0x54dcb4[_0x40aeb8(0x1fb)]);_0x53415d?_0x53415d[_0x40aeb8(0x226)]+=0x1:_0x36b5b6[_0x40aeb8(0x1f2)]({..._0x54dcb4,'count':0x1});}return _0x36b5b6=_0x36b5b6[_0x40aeb8(0x21c)](_0x363149=>_0x363149['count']>=0x5),_0x36b5b6;}}