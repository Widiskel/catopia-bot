const a2_0x1934b4=a2_0x38c0;(function(_0x18cd70,_0x2617f4){const _0x2886ee=a2_0x38c0,_0x2fa8d3=_0x18cd70();while(!![]){try{const _0x1c7c35=-parseInt(_0x2886ee(0xee))/0x1+-parseInt(_0x2886ee(0xb3))/0x2*(-parseInt(_0x2886ee(0xa8))/0x3)+-parseInt(_0x2886ee(0x115))/0x4*(-parseInt(_0x2886ee(0xc2))/0x5)+parseInt(_0x2886ee(0x10e))/0x6*(-parseInt(_0x2886ee(0xd0))/0x7)+parseInt(_0x2886ee(0xd2))/0x8*(parseInt(_0x2886ee(0xce))/0x9)+-parseInt(_0x2886ee(0xf7))/0xa+parseInt(_0x2886ee(0x9a))/0xb;if(_0x1c7c35===_0x2617f4)break;else _0x2fa8d3['push'](_0x2fa8d3['shift']());}catch(_0x3ad450){_0x2fa8d3['push'](_0x2fa8d3['shift']());}}}(a2_0x1b4e,0x61e7c));import{API}from'../api/api.js';import{Helper}from'../utils/helper.js';import a2_0x3312e9 from'../utils/logger.js';function a2_0x1b4e(){const _0x4a0ed3=['Successfully\x20Buying\x201\x20Grapes','refreshToken','Getting\x20Missions...','/api/v1/chest/open-multiple','GET','Successfully\x20get\x20player\x20pet','Successfully\x20planting\x20grapes\x20to\x20land\x20','login','generateUpgradablePet','Upgrading\x20pet\x20','702WSPkwu','\x20GOLD','connect','petTypeId','/api/v1/user-collection/claim-gold','pet','missions','20hbilfu','reduce','Successfully\x20Opening\x20Multiple\x20Chest','petCompanion','WSS\x20Handshake\x20Error:\x20','2113771eAUrsV','token','\x20Successfully\x20Upgraded\x20to\x20Level\x20','typeId','buyingGrapes','gold','Claiming\x20Gold...','claimMission','initWss','name','plantString','WSS\x20Connection\x20Error:\x20','Successfully\x20Get\x20Misisons','/api/v1/players/plant/harvestAll','245205mtaHCN','mission','Successfully\x20Get\x20Player\x20Plant','account','Successfully\x20Claim\x20Gold,\x20got\x20','data','query','Successfully\x20Get\x20User\x20Info','Getting\x20User\x20Info...','Buying\x20Grapes...','/api/v1/players/pet?limit=3000','6maSemP','websocket','claimGold','Successfully\x20Harvest\x20All\x20Plant\x20Got\x20','...','WSS\x20Connection\x20Timeout','WSS\x20Handshake\x20completed\x20and\x20connected.','WSS\x20Error\x20:\x20','WSS\x20Connected...','gem','getMission','/claim','Error\x20:\x20','delay','Successfully\x20Login','457675IWOFKD','connect_error','upgradePet','\x20GEM\x20&\x20','Successfully\x20Get\x20Seed\x20List','getAvailablePlant','0\x20Grapes','join','socket','disconnect','/api/v1/user-collection?limit=3000','/api/v1/players/pet/upgrade','6502851dibiyL','/api/v1/players/plant','24087OpDchI','message','8hqRKNi','type','Pet\x20','getUser','accessToken','Getting\x20player\x20pet...','getLands','getSeedList','WSS\x20Handshake\x20Timeout','connect_timeout','/api/v1/auth/telegram','getChest','WSS\x20Connection\x20Closed\x20','/api/v1/seed?limit=3000','error','success','Getting\x20Player\x20Plant...','https://api.catopia.io','count','Getting\x20User\x20Land\x20Info...','Getting\x20Seed\x20List...','/api/v1/players/land?limit=3000','land','Try\x20to\x20Login...','/api/v1/players/plant?limit=3000','entries','filter','/api/v1/players/chest?limit=3000','557046ntdZXj','queryObj','/api/v1/store/buy','Socket\x20ID:\x20','Buying\x20common\x20chest...','/api/v1/user/daily-mission/','POST','map','Planting\x20Gapes\x20seed\x20to\x20land...','2569170PiLwio','petTypeList','Connecting\x20to\x20WSS...','level','plant','seed','/api/v1/user/daily-mission?limit=3000','info','claimedCoin','harvestAll','Claiming\x20Missions\x20','chest','fetch'];a2_0x1b4e=function(){return _0x4a0ed3;};return a2_0x1b4e();}function a2_0x38c0(_0x283882,_0x3afcf0){const _0x1b4e02=a2_0x1b4e();return a2_0x38c0=function(_0x38c004,_0x3b1aa){_0x38c004=_0x38c004-0x96;let _0x191511=_0x1b4e02[_0x38c004];return _0x191511;},a2_0x38c0(_0x283882,_0x3afcf0);}import{io}from'socket.io-client';import{PetList}from'./pet_list.js';import{Config}from'../../config/config.js';export class Catopia extends API{constructor(_0x510817,_0x118e81,_0x532936,_0x1f1669){const _0x3cbeaa=a2_0x38c0;super(_0x118e81,_0x3cbeaa(0xe3),_0x1f1669),this['account']=_0x510817,this['query']=_0x118e81,this[_0x3cbeaa(0xef)]=_0x532936;}async[a2_0x1934b4(0x10b)](){const _0x513a9f=a2_0x1934b4;try{await Helper[_0x513a9f(0xc0)](0x1f4,this[_0x513a9f(0xab)],_0x513a9f(0xe9),this);const _0x24fbf9=await this[_0x513a9f(0x103)](_0x513a9f(0xdc),_0x513a9f(0xf4),undefined,{'initData':this[_0x513a9f(0xae)]});await Helper[_0x513a9f(0xc0)](0x3e8,this[_0x513a9f(0xab)],_0x513a9f(0xc1),this),this[_0x513a9f(0x9b)]=_0x24fbf9['data'][_0x513a9f(0xd6)],this[_0x513a9f(0x105)]=_0x24fbf9[_0x513a9f(0x105)];}catch(_0x39a1d3){throw _0x39a1d3;}}async[a2_0x1934b4(0xd5)](_0x27abe6=![]){const _0x27d534=a2_0x1934b4;try{if(_0x27abe6)await Helper['delay'](0x1f4,this[_0x27d534(0xab)],_0x27d534(0xb0),this);const _0x22afcd=await this[_0x27d534(0x103)](_0x27d534(0xcc),_0x27d534(0x108),this[_0x27d534(0x9b)]);if(_0x22afcd[_0x27d534(0xe1)]==!![]){if(_0x27abe6)await Helper[_0x27d534(0xc0)](0x3e8,this[_0x27d534(0xab)],_0x27d534(0xaf),this);this['user']=_0x22afcd[_0x27d534(0xad)];}else await Helper[_0x27d534(0xc0)](0x1388,this[_0x27d534(0xab)],_0x27d534(0xbf)+_0x22afcd[_0x27d534(0xd1)],this);}catch(_0x1301e3){throw _0x1301e3;}}async[a2_0x1934b4(0xa2)](){return new Promise(async(_0x263e5f,_0x58185a)=>{const _0x5f3348=a2_0x38c0;await Helper[_0x5f3348(0xc0)](0x3e8,this['account'],_0x5f3348(0xf9),this),this[_0x5f3348(0xca)]=io('wss://cowtopia-ws.tonfarmer.com',{'auth':{'token':this['plainToken']},'transports':[_0x5f3348(0xb4)]}),this['socket']['on'](_0x5f3348(0x110),async()=>{const _0x35ec67=_0x5f3348;await Helper[_0x35ec67(0xc0)](0x3e8,this[_0x35ec67(0xab)],_0x35ec67(0xbb),this),a2_0x3312e9[_0x35ec67(0xfe)](_0x35ec67(0xb9)),a2_0x3312e9[_0x35ec67(0xfe)](_0x35ec67(0xf1)+this[_0x35ec67(0xca)]['id']),_0x263e5f();}),this[_0x5f3348(0xca)]['on'](_0x5f3348(0xc3),async _0x4001d1=>{const _0x175d44=_0x5f3348;await Helper[_0x175d44(0xc0)](0x3e8,this[_0x175d44(0xab)],_0x175d44(0xa5)+_0x4001d1[_0x175d44(0xd1)],this),a2_0x3312e9[_0x175d44(0xe0)](_0x175d44(0x99)+_0x4001d1[_0x175d44(0xd1)]),_0x58185a(_0x4001d1);}),this['socket']['on'](_0x5f3348(0xdb),async()=>{const _0x4d34f3=_0x5f3348;await Helper[_0x4d34f3(0xc0)](0x3e8,this[_0x4d34f3(0xab)],_0x4d34f3(0xb8),this),a2_0x3312e9[_0x4d34f3(0xe0)](_0x4d34f3(0xda)),_0x58185a(new Error(_0x4d34f3(0xda)));}),this['socket']['on'](_0x5f3348(0xe0),async _0x56d94e=>{const _0x55de16=_0x5f3348;await Helper[_0x55de16(0xc0)](0x3e8,this[_0x55de16(0xab)],_0x55de16(0xba)+_0x56d94e['message'],this),a2_0x3312e9[_0x55de16(0xe0)](_0x55de16(0xba)+_0x56d94e[_0x55de16(0xd1)]),_0x58185a(_0x56d94e);}),this[_0x5f3348(0xca)]['on'](_0x5f3348(0xcb),async _0x412cf3=>{const _0x401577=_0x5f3348;await Helper[_0x401577(0xc0)](0x3e8,this[_0x401577(0xab)],_0x401577(0xde)+_0x412cf3+_0x401577(0xb7),this),a2_0x3312e9[_0x401577(0xfe)]('WSS\x20Disconnected:\x20'+_0x412cf3);});});}async[a2_0x1934b4(0xbd)](_0x41c0e0=![]){const _0xec1459=a2_0x1934b4;try{if(_0x41c0e0)await Helper[_0xec1459(0xc0)](0x1f4,this[_0xec1459(0xab)],_0xec1459(0x106),this);this['missions']=[];const _0x165a9e=await this[_0xec1459(0x103)](_0xec1459(0xfd),_0xec1459(0x108),this['token']);if(_0x165a9e['success']){if(_0x41c0e0)await Helper['delay'](0x3e8,this[_0xec1459(0xab)],_0xec1459(0xa6),this);this[_0xec1459(0x114)]=_0x165a9e[_0xec1459(0xad)];}else await Helper[_0xec1459(0xc0)](0x1388,this['account'],_0xec1459(0xbf)+_0x165a9e[_0xec1459(0xd1)],this);}catch(_0x483a4f){throw _0x483a4f;}}async[a2_0x1934b4(0xa1)](_0xe09662){const _0x16209d=a2_0x1934b4;try{await Helper['delay'](0x1f4,this[_0x16209d(0xab)],_0x16209d(0x101)+_0xe09662[_0x16209d(0xa9)]['title']+_0x16209d(0xb7),this);const _0x5e857a=await this[_0x16209d(0x103)](_0x16209d(0xf3)+_0xe09662['id']+_0x16209d(0xbe),_0x16209d(0xf4),this[_0x16209d(0x9b)]);_0x5e857a[_0x16209d(0xe1)]?(await Helper[_0x16209d(0xc0)](0x3e8,this[_0x16209d(0xab)],'Successfully\x20Claim\x20Misisons',this),await this['getUser'](),await this['getMission']()):await Helper['delay'](0x1388,this[_0x16209d(0xab)],_0x16209d(0xbf)+_0x5e857a[_0x16209d(0xd1)],this);}catch(_0x297807){throw _0x297807;}}async[a2_0x1934b4(0xd9)](){const _0x5c4d17=a2_0x1934b4;try{await Helper[_0x5c4d17(0xc0)](0x1f4,this[_0x5c4d17(0xab)],_0x5c4d17(0xe6),this);const _0x236d61=await this[_0x5c4d17(0x103)](_0x5c4d17(0xdf),_0x5c4d17(0x108),this[_0x5c4d17(0x9b)]);_0x236d61[_0x5c4d17(0xe1)]?(await Helper['delay'](0x3e8,this[_0x5c4d17(0xab)],_0x5c4d17(0xc6),this),this[_0x5c4d17(0xfc)]=_0x236d61[_0x5c4d17(0xad)]):await Helper[_0x5c4d17(0xc0)](0x1388,this[_0x5c4d17(0xab)],_0x5c4d17(0xbf)+_0x236d61[_0x5c4d17(0xd1)],this);}catch(_0xaf3353){throw _0xaf3353;}}async[a2_0x1934b4(0xc7)](_0x2b85e5=![]){const _0x3b809b=a2_0x1934b4;try{if(_0x2b85e5)await Helper['delay'](0x1f4,this[_0x3b809b(0xab)],_0x3b809b(0xe2),this);const _0x91a543=await this['fetch'](_0x3b809b(0xea),_0x3b809b(0x108),this[_0x3b809b(0x9b)]);if(_0x91a543['success']){if(_0x2b85e5)await Helper['delay'](0x3e8,this[_0x3b809b(0xab)],_0x3b809b(0xaa),this);this[_0x3b809b(0xfb)]=_0x91a543[_0x3b809b(0xad)];const _0x3eec43=this[_0x3b809b(0xfb)][_0x3b809b(0x96)]((_0x9b124b,_0x1000f7)=>{const _0x50aac7=_0x3b809b,_0x325150=_0x1000f7[_0x50aac7(0xa3)];return _0x9b124b[_0x325150]=(_0x9b124b[_0x325150]||0x0)+0x1,_0x9b124b;},{});this[_0x3b809b(0xa4)]=Object[_0x3b809b(0xeb)](_0x3eec43)['map'](([_0x39e8ed,_0x58ceb5])=>_0x58ceb5+'\x20Grapes')[_0x3b809b(0xc9)]('\x20'),(this[_0x3b809b(0xa4)]==''||this['plantString']==undefined)&&(this[_0x3b809b(0xa4)]=_0x3b809b(0xc8));}else await Helper[_0x3b809b(0xc0)](0x1388,this[_0x3b809b(0xab)],_0x3b809b(0xbf)+_0x91a543[_0x3b809b(0xd1)],this);}catch(_0x5f443f){throw _0x5f443f;}}async[a2_0x1934b4(0x9e)](){const _0x6297a1=a2_0x1934b4;try{await Helper[_0x6297a1(0xc0)](0x1f4,this[_0x6297a1(0xab)],_0x6297a1(0xb1),this);const _0x103683=await this['fetch']('/api/v1/store/buy',_0x6297a1(0xf4),this['token'],{'storeId':0x11,'price':0x3e80,'unit':0x1});await this['getUser'](),_0x103683[_0x6297a1(0xe1)]?(await Helper[_0x6297a1(0xc0)](0x3e8,this[_0x6297a1(0xab)],_0x6297a1(0x104),this),await this[_0x6297a1(0xc7)]()):(await Helper[_0x6297a1(0xc0)](0x1388,this[_0x6297a1(0xab)],''+_0x103683[_0x6297a1(0xd1)],this),await this[_0x6297a1(0x100)]());}catch(_0x2c1f2d){throw _0x2c1f2d;}}async[a2_0x1934b4(0xd8)](_0x1dc4f7=![]){const _0x52f16=a2_0x1934b4;try{if(_0x1dc4f7)await Helper[_0x52f16(0xc0)](0x1f4,this[_0x52f16(0xab)],_0x52f16(0xe5),this);const _0x10dff1=await this[_0x52f16(0x103)](_0x52f16(0xe7),_0x52f16(0x108),this[_0x52f16(0x9b)]);if(_0x10dff1[_0x52f16(0xe1)]){if(_0x1dc4f7)await Helper[_0x52f16(0xc0)](0x3e8,this[_0x52f16(0xab)],'Successfully\x20Get\x20User\x20Land\x20Info',this);this[_0x52f16(0xe8)]=_0x10dff1[_0x52f16(0xad)];}else await Helper['delay'](0x1388,this[_0x52f16(0xab)],_0x52f16(0xbf)+_0x10dff1[_0x52f16(0xd1)],this);}catch(_0x146159){throw _0x146159;}}async['plantSeed'](_0x3fb0f1){const _0x1cf2b8=a2_0x1934b4;try{await Helper['delay'](0x1f4,this['account'],_0x1cf2b8(0xf6),this);const _0x13befc=await this[_0x1cf2b8(0x103)](_0x1cf2b8(0xcf),'POSt',this[_0x1cf2b8(0x9b)],{'plantId':this['plant'][0x0]['id'],'landId':_0x3fb0f1});_0x13befc[_0x1cf2b8(0xe1)]?(await Helper['delay'](0x3e8,this['account'],_0x1cf2b8(0x10a)+_0x3fb0f1,this),await this['getLands'](),await this[_0x1cf2b8(0xc7)]()):await Helper[_0x1cf2b8(0xc0)](0x1388,this[_0x1cf2b8(0xab)],_0x1cf2b8(0xbf)+_0x13befc[_0x1cf2b8(0xd1)],this);}catch(_0xe11d7a){throw _0xe11d7a;}}async[a2_0x1934b4(0x100)](){const _0x2a962a=a2_0x1934b4;try{await Helper[_0x2a962a(0xc0)](0x1f4,this[_0x2a962a(0xab)],'Harvesting\x20all...',this);const _0x5a5df2=await this['fetch'](_0x2a962a(0xa7),'POSt',this[_0x2a962a(0x9b)]);_0x5a5df2[_0x2a962a(0xe1)]?(await Helper['delay'](0x7d0,this[_0x2a962a(0xab)],_0x2a962a(0xb6)+_0x5a5df2['data'][_0x2a962a(0xbc)]+_0x2a962a(0xc5)+_0x5a5df2[_0x2a962a(0xad)][_0x2a962a(0x9f)]+_0x2a962a(0x10f),this),await this['getUser'](),await this['getLands'](),await this[_0x2a962a(0xc7)]()):await Helper[_0x2a962a(0xc0)](0x7d0,this[_0x2a962a(0xab)],''+_0x5a5df2[_0x2a962a(0xd1)],this);}catch(_0x52333){throw _0x52333;}}async['getPet'](_0x5dc07c){const _0x128166=a2_0x1934b4;try{if(_0x5dc07c)await Helper[_0x128166(0xc0)](0x1f4,this['account'],_0x128166(0xd7),this);const _0x36f9ed=await this[_0x128166(0x103)](_0x128166(0xb2),_0x128166(0x108),this[_0x128166(0x9b)]);if(_0x36f9ed[_0x128166(0xe1)]){if(_0x5dc07c)await Helper[_0x128166(0xc0)](0xbb8,this[_0x128166(0xab)],_0x128166(0x109),this);this[_0x128166(0x113)]=_0x36f9ed['data'];}else await Helper[_0x128166(0xc0)](0xbb8,this[_0x128166(0xab)],''+_0x36f9ed[_0x128166(0xd1)],this);}catch(_0x43f49e){throw _0x43f49e;}}async['buyChest'](){const _0x15dae2=a2_0x1934b4;try{await Helper[_0x15dae2(0xc0)](0x1f4,this['account'],_0x15dae2(0xf2),this);const _0x197465=await this[_0x15dae2(0x103)](_0x15dae2(0xf0),_0x15dae2(0xf4),this[_0x15dae2(0x9b)],{'storeId':0x2,'price':0x7530,'unit':0x1});_0x197465[_0x15dae2(0xe1)]?(await this[_0x15dae2(0xd5)](),await this['getChest']()):await Helper[_0x15dae2(0xc0)](0xbb8,this[_0x15dae2(0xab)],''+_0x197465[_0x15dae2(0xd1)],this);}catch(_0x4f9d0b){throw _0x4f9d0b;}}async[a2_0x1934b4(0xdd)](){const _0x6b6254=a2_0x1934b4;try{const _0x23a562=await this[_0x6b6254(0x103)](_0x6b6254(0xed),_0x6b6254(0x108),this[_0x6b6254(0x9b)]);_0x23a562['success']?this[_0x6b6254(0x102)]=_0x23a562[_0x6b6254(0xad)]:await Helper['delay'](0xbb8,this[_0x6b6254(0xab)],''+res['message'],this);}catch(_0x25b288){throw _0x25b288;}}async['openChest'](){const _0x1ff5f7=a2_0x1934b4;try{const _0x340760=Config['COMPANION']??'A';await Helper[_0x1ff5f7(0xc0)](0x1f4,this[_0x1ff5f7(0xab)],'Opening\x20multipe\x20chest...',this);const _0x3dcde0=await this[_0x1ff5f7(0x103)](_0x1ff5f7(0x107),_0x1ff5f7(0xf4),this['token'],{'petTypeIds':PetList[_0x1ff5f7(0x98)]['find'](_0x3f3cb4=>_0x3f3cb4[_0x1ff5f7(0xd3)]==_0x340760)[_0x1ff5f7(0xad)],'chestIds':this[_0x1ff5f7(0x102)][_0x1ff5f7(0xf5)](_0x17aa42=>{return _0x17aa42['id'];})});_0x3dcde0[_0x1ff5f7(0xe1)]?(await this[_0x1ff5f7(0xdd)](),await Helper[_0x1ff5f7(0xc0)](0x3e8,this[_0x1ff5f7(0xab)],_0x1ff5f7(0x97),this)):await Helper[_0x1ff5f7(0xc0)](0xbb8,this[_0x1ff5f7(0xab)],''+_0x3dcde0[_0x1ff5f7(0xd1)],this);}catch(_0x245f2f){throw _0x245f2f;}}async[a2_0x1934b4(0xc4)](_0x123ea8){const _0x59b7de=a2_0x1934b4;try{console['log'](_0x123ea8),await Helper['delay'](0x1f4,this[_0x59b7de(0xab)],_0x59b7de(0x10d)+_0x123ea8['typeId']+'\x20Level\x20'+_0x123ea8['level']+'...',this);const _0x114843=PetList[_0x59b7de(0xf8)]['find'](_0x45dd1b=>_0x45dd1b[_0x59b7de(0x111)]==_0x123ea8[_0x59b7de(0x9d)]),_0x2a407f=await this[_0x59b7de(0x103)](_0x59b7de(0xcd),_0x59b7de(0xf4),this[_0x59b7de(0x9b)],{'level':_0x123ea8['level'],'petTypeId':_0x114843[_0x59b7de(0x111)]});_0x2a407f[_0x59b7de(0xe1)]?(await this['getPet'](),await Helper[_0x59b7de(0xc0)](0x3e8,this[_0x59b7de(0xab)],_0x59b7de(0xd4)+_0x123ea8[_0x59b7de(0x9d)]+_0x59b7de(0x9c)+(_0x123ea8[_0x59b7de(0xfa)]+0x1)+'\x20',this)):await Helper[_0x59b7de(0xc0)](0xbb8,this[_0x59b7de(0xab)],''+_0x2a407f['message'],this);}catch(_0xcdd154){throw _0xcdd154;}}async[a2_0x1934b4(0xb5)](){const _0x26ca7c=a2_0x1934b4;try{await Helper[_0x26ca7c(0xc0)](0x1f4,this[_0x26ca7c(0xab)],_0x26ca7c(0xa0),this);const _0x18239f=await this[_0x26ca7c(0x103)](_0x26ca7c(0x112),'POST',this[_0x26ca7c(0x9b)]);_0x18239f[_0x26ca7c(0xe1)]?(await this[_0x26ca7c(0xd5)](),await Helper[_0x26ca7c(0xc0)](0x3e8,this[_0x26ca7c(0xab)],_0x26ca7c(0xac)+_0x18239f[_0x26ca7c(0xad)][_0x26ca7c(0xff)]+_0x26ca7c(0x10f),this)):await Helper[_0x26ca7c(0xc0)](0xbb8,this['account'],''+_0x18239f[_0x26ca7c(0xd1)],this);}catch(_0x13f2aa){throw _0x13f2aa;}}async[a2_0x1934b4(0x10c)](){const _0x1d442d=a2_0x1934b4;let _0x2d4a42=[];for(const _0x45e42f of this[_0x1d442d(0x113)]){const _0x18e343=_0x2d4a42['find'](_0x11b184=>_0x11b184[_0x1d442d(0x9d)]===_0x45e42f['typeId']&&_0x11b184[_0x1d442d(0xfa)]===_0x45e42f['level']);_0x18e343?_0x18e343['count']+=0x1:_0x2d4a42['push']({..._0x45e42f,'count':0x1});}return _0x2d4a42=_0x2d4a42[_0x1d442d(0xec)](_0x369268=>_0x369268[_0x1d442d(0xe4)]>=0x5),_0x2d4a42;}}