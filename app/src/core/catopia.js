const a2_0x176d21=a2_0x4be7;(function(_0x5247cf,_0x27e893){const _0x356c3c=a2_0x4be7,_0x2f2ee8=_0x5247cf();while(!![]){try{const _0x5321c3=-parseInt(_0x356c3c(0x117))/0x1*(-parseInt(_0x356c3c(0xbd))/0x2)+parseInt(_0x356c3c(0xfd))/0x3+-parseInt(_0x356c3c(0x12f))/0x4*(-parseInt(_0x356c3c(0xd5))/0x5)+-parseInt(_0x356c3c(0x10d))/0x6*(parseInt(_0x356c3c(0xe4))/0x7)+parseInt(_0x356c3c(0xc3))/0x8*(-parseInt(_0x356c3c(0xe9))/0x9)+-parseInt(_0x356c3c(0xc1))/0xa+parseInt(_0x356c3c(0xc4))/0xb*(parseInt(_0x356c3c(0xce))/0xc);if(_0x5321c3===_0x27e893)break;else _0x2f2ee8['push'](_0x2f2ee8['shift']());}catch(_0x2bb870){_0x2f2ee8['push'](_0x2f2ee8['shift']());}}}(a2_0x12cc,0xc99a1));import{API}from'../api/api.js';function a2_0x4be7(_0xbeb93f,_0x24b09d){const _0x12cc5f=a2_0x12cc();return a2_0x4be7=function(_0x4be711,_0x5356bc){_0x4be711=_0x4be711-0xb6;let _0x1b9348=_0x12cc5f[_0x4be711];return _0x1b9348;},a2_0x4be7(_0xbeb93f,_0x24b09d);}function a2_0x12cc(){const _0x1ed35d=['1359726xOCAHO','find','/api/v1/user/daily-mission?limit=3000','COMPANION','Opening\x20multipe\x20chest...','POST','Socket\x20ID:\x20','count','buyingGrapes','/api/v1/auth/telegram','2QNYHSu','https://api.catopia.io','getSeedList','websocket','error','Getting\x20Missions...','token','petTypeId','queryObj','connect','fetch','Connecting\x20to\x20WSS...','Successfully\x20get\x20player\x20pet','map','data','/api/v1/user/daily-mission/','/api/v1/players/land?limit=3000','/api/v1/store/buy','Getting\x20player\x20pet...','Getting\x20User\x20Info...','accessToken','/api/v1/user-collection/claim-gold','\x20GOLD','WSS\x20Connection\x20Timeout','8XlNUZp','/api/v1/chest/open-multiple','WSS\x20Connection\x20Error:\x20','Successfully\x20Get\x20User\x20Land\x20Info','...','upgrading\x20pet\x20','getChest','account','gold','query','refreshToken','Try\x20to\x20Login...','petTypeList','Upgrading\x20pet\x20','1573898JTgHyx','getAvailablePlant','user','buyChest','15737610qNxHWQ','Successfully\x20Harvest\x20All\x20Plant\x20Got\x20','9795392KEgbhp','154oONcvL','Successfully\x20Claim\x20Misisons','Claiming\x20Missions\x20','petCompanion','harvestAll','openChest','WSS\x20Handshake\x20completed\x20and\x20connected.','Successfully\x20Login','Buying\x20Grapes...','disconnect','1547868HYnmbe','\x20GEM\x20&\x20','wss://cowtopia-ws.tonfarmer.com','upgradePet','Getting\x20Seed\x20List...','push','land','954285vyGohA','/claim','WSS\x20Handshake\x20Timeout','message','chest','pet','log','initWss','Successfully\x20Get\x20Player\x20Plant','success','WSS\x20Disconnected:\x20','Pet\x20','join','WSS\x20Connection\x20Closed\x20','seed','14LJvTlK','WSS\x20Handshake\x20Error:\x20','Planting\x20Gapes\x20seed\x20to\x20land...','Harvesting\x20all...','socket','9fjtUkg','claimedCoin','plantString','delay','name','Successfully\x20Get\x20Seed\x20List','Claiming\x20Gold...','generateUpgradablePet','Successfully\x20Opening\x20Multiple\x20Chest','getUser','level','\x20Successfully\x20Upgraded\x20to\x20Level\x20','\x20Level\x20','Successfully\x20Get\x20User\x20Info','filter','title','WSS\x20Connected...','/api/v1/players/pet/upgrade','Successfully\x20Buying\x201\x20Grapes','getLands','947190JGjBny','/api/v1/players/plant/harvestAll','Error\x20:\x20','GET','/api/v1/players/plant','Successfully\x20planting\x20grapes\x20to\x20land\x20','info','WSS\x20Error\x20:\x20','Successfully\x20Get\x20Misisons','plant','/api/v1/players/pet?limit=3000','connect_error','POSt','missions','getPet','getMission'];a2_0x12cc=function(){return _0x1ed35d;};return a2_0x12cc();}import{Helper}from'../utils/helper.js';import a2_0x3f8924 from'../utils/logger.js';import{io}from'socket.io-client';import{PetList}from'./pet_list.js';import{Config}from'../../config/config.js';export class Catopia extends API{constructor(_0x1b2b7b,_0x5e5746,_0x323ab0,_0xa5644b){const _0x535975=a2_0x4be7;super(_0x5e5746,_0x535975(0x118),_0xa5644b),this[_0x535975(0xb6)]=_0x1b2b7b,this[_0x535975(0xb8)]=_0x5e5746,this[_0x535975(0x11f)]=_0x323ab0;}async['login'](){const _0x100413=a2_0x4be7;try{await Helper[_0x100413(0xec)](0x1f4,this[_0x100413(0xb6)],_0x100413(0xba),this);const _0x4f70c7=await this[_0x100413(0x121)](_0x100413(0x116),_0x100413(0x112),undefined,{'initData':this['query']});await Helper['delay'](0x3e8,this[_0x100413(0xb6)],_0x100413(0xcb),this),this[_0x100413(0x11d)]=_0x4f70c7['data'][_0x100413(0x12b)],this[_0x100413(0xb9)]=_0x4f70c7['refreshToken'];}catch(_0x5afc52){throw _0x5afc52;}}async[a2_0x176d21(0xf2)](_0x93cd3f=![]){const _0x2668b6=a2_0x176d21;try{if(_0x93cd3f)await Helper[_0x2668b6(0xec)](0x1f4,this['account'],_0x2668b6(0x12a),this);const _0x15a902=await this[_0x2668b6(0x121)]('/api/v1/user-collection?limit=3000',_0x2668b6(0x100),this['token']);if(_0x15a902[_0x2668b6(0xde)]==!![]){if(_0x93cd3f)await Helper[_0x2668b6(0xec)](0x3e8,this[_0x2668b6(0xb6)],_0x2668b6(0xf6),this);this[_0x2668b6(0xbf)]=_0x15a902['data'];}else await Helper[_0x2668b6(0xec)](0x1388,this[_0x2668b6(0xb6)],_0x2668b6(0xff)+_0x15a902[_0x2668b6(0xd8)],this);}catch(_0x24d2e3){throw _0x24d2e3;}}async[a2_0x176d21(0xdc)](){return new Promise(async(_0x390ce7,_0xe74cae)=>{const _0x340fb5=a2_0x4be7;await Helper['delay'](0x3e8,this['account'],_0x340fb5(0x122),this),this[_0x340fb5(0xe8)]=io(_0x340fb5(0xd0),{'auth':{'token':this['plainToken']},'transports':[_0x340fb5(0x11a)]}),this[_0x340fb5(0xe8)]['on'](_0x340fb5(0x120),async()=>{const _0x27f8c8=_0x340fb5;await Helper['delay'](0x3e8,this['account'],_0x27f8c8(0xf9),this),a2_0x3f8924['info'](_0x27f8c8(0xca)),a2_0x3f8924[_0x27f8c8(0x103)](_0x27f8c8(0x113)+this['socket']['id']),_0x390ce7();}),this[_0x340fb5(0xe8)]['on'](_0x340fb5(0x108),async _0x2b294b=>{const _0x9d9f4f=_0x340fb5;await Helper[_0x9d9f4f(0xec)](0x3e8,this[_0x9d9f4f(0xb6)],_0x9d9f4f(0x131)+_0x2b294b[_0x9d9f4f(0xd8)],this),a2_0x3f8924['error'](_0x9d9f4f(0xe5)+_0x2b294b[_0x9d9f4f(0xd8)]),_0xe74cae(_0x2b294b);}),this['socket']['on']('connect_timeout',async()=>{const _0x5e6a12=_0x340fb5;await Helper['delay'](0x3e8,this[_0x5e6a12(0xb6)],_0x5e6a12(0x12e),this),a2_0x3f8924[_0x5e6a12(0x11b)](_0x5e6a12(0xd7)),_0xe74cae(new Error(_0x5e6a12(0xd7)));}),this[_0x340fb5(0xe8)]['on'](_0x340fb5(0x11b),async _0xbcdd15=>{const _0x2ca885=_0x340fb5;await Helper[_0x2ca885(0xec)](0x3e8,this[_0x2ca885(0xb6)],_0x2ca885(0x104)+_0xbcdd15[_0x2ca885(0xd8)],this),a2_0x3f8924[_0x2ca885(0x11b)]('WSS\x20Error\x20:\x20'+_0xbcdd15[_0x2ca885(0xd8)]),_0xe74cae(_0xbcdd15);}),this[_0x340fb5(0xe8)]['on'](_0x340fb5(0xcd),async _0x2b3dc3=>{const _0x1fcb12=_0x340fb5;await Helper['delay'](0x3e8,this[_0x1fcb12(0xb6)],_0x1fcb12(0xe2)+_0x2b3dc3+'...',this),a2_0x3f8924[_0x1fcb12(0x103)](_0x1fcb12(0xdf)+_0x2b3dc3);});});}async[a2_0x176d21(0x10c)](_0x53328d=![]){const _0x28d853=a2_0x176d21;try{if(_0x53328d)await Helper[_0x28d853(0xec)](0x1f4,this[_0x28d853(0xb6)],_0x28d853(0x11c),this);this[_0x28d853(0x10a)]=[];const _0x35e2ba=await this[_0x28d853(0x121)](_0x28d853(0x10f),_0x28d853(0x100),this[_0x28d853(0x11d)]);if(_0x35e2ba['success']){if(_0x53328d)await Helper[_0x28d853(0xec)](0x3e8,this['account'],_0x28d853(0x105),this);this[_0x28d853(0x10a)]=_0x35e2ba[_0x28d853(0x125)];}else await Helper['delay'](0x1388,this['account'],_0x28d853(0xff)+_0x35e2ba[_0x28d853(0xd8)],this);}catch(_0x32298e){throw _0x32298e;}}async['claimMission'](_0x351813){const _0x30adc9=a2_0x176d21;try{await Helper[_0x30adc9(0xec)](0x1f4,this[_0x30adc9(0xb6)],_0x30adc9(0xc6)+_0x351813['mission'][_0x30adc9(0xf8)]+'...',this);const _0x209ff5=await this[_0x30adc9(0x121)](_0x30adc9(0x126)+_0x351813['id']+_0x30adc9(0xd6),_0x30adc9(0x112),this['token']);_0x209ff5[_0x30adc9(0xde)]?(await Helper['delay'](0x3e8,this[_0x30adc9(0xb6)],_0x30adc9(0xc5),this),await this['getUser'](),await this['getMission']()):await Helper[_0x30adc9(0xec)](0x1388,this['account'],_0x30adc9(0xff)+_0x209ff5[_0x30adc9(0xd8)],this);}catch(_0x433bc0){throw _0x433bc0;}}async[a2_0x176d21(0x119)](){const _0xba71e5=a2_0x176d21;try{await Helper['delay'](0x1f4,this[_0xba71e5(0xb6)],_0xba71e5(0xd2),this);const _0x277ae8=await this[_0xba71e5(0x121)]('/api/v1/seed?limit=3000',_0xba71e5(0x100),this[_0xba71e5(0x11d)]);_0x277ae8[_0xba71e5(0xde)]?(await Helper[_0xba71e5(0xec)](0x3e8,this[_0xba71e5(0xb6)],_0xba71e5(0xee),this),this[_0xba71e5(0xe3)]=_0x277ae8[_0xba71e5(0x125)]):await Helper[_0xba71e5(0xec)](0x1388,this[_0xba71e5(0xb6)],_0xba71e5(0xff)+_0x277ae8[_0xba71e5(0xd8)],this);}catch(_0x1a19a3){throw _0x1a19a3;}}async['getAvailablePlant'](_0x41e3d4=![]){const _0x38d621=a2_0x176d21;try{if(_0x41e3d4)await Helper[_0x38d621(0xec)](0x1f4,this[_0x38d621(0xb6)],'Getting\x20Player\x20Plant...',this);const _0x2ed3a7=await this['fetch']('/api/v1/players/plant?limit=3000',_0x38d621(0x100),this['token']);if(_0x2ed3a7['success']){if(_0x41e3d4)await Helper[_0x38d621(0xec)](0x3e8,this[_0x38d621(0xb6)],_0x38d621(0xdd),this);this[_0x38d621(0x106)]=_0x2ed3a7[_0x38d621(0x125)];const _0x94dd31=this[_0x38d621(0x106)]['reduce']((_0x1c01e2,_0x25da8a)=>{const _0x2e5aa7=_0x25da8a['name'];return _0x1c01e2[_0x2e5aa7]=(_0x1c01e2[_0x2e5aa7]||0x0)+0x1,_0x1c01e2;},{});this[_0x38d621(0xeb)]=Object['entries'](_0x94dd31)[_0x38d621(0x124)](([_0x54e553,_0x3fa4b9])=>_0x3fa4b9+'\x20Grapes')[_0x38d621(0xe1)]('\x20');}else await Helper[_0x38d621(0xec)](0x1388,this[_0x38d621(0xb6)],_0x38d621(0xff)+_0x2ed3a7[_0x38d621(0xd8)],this);}catch(_0x3bc8cc){throw _0x3bc8cc;}}async[a2_0x176d21(0x115)](){const _0x5c7d2b=a2_0x176d21;try{await Helper['delay'](0x1f4,this[_0x5c7d2b(0xb6)],_0x5c7d2b(0xcc),this);const _0x375028=await this['fetch'](_0x5c7d2b(0x128),_0x5c7d2b(0x112),this[_0x5c7d2b(0x11d)],{'storeId':0x11,'price':0x3e80,'unit':0x1});await this[_0x5c7d2b(0xf2)](),_0x375028['success']?(await Helper[_0x5c7d2b(0xec)](0x3e8,this[_0x5c7d2b(0xb6)],_0x5c7d2b(0xfb),this),await this['getAvailablePlant']()):(await Helper['delay'](0x1388,this[_0x5c7d2b(0xb6)],''+_0x375028[_0x5c7d2b(0xd8)],this),await this['harvestAll']());}catch(_0x483c92){throw _0x483c92;}}async[a2_0x176d21(0xfc)](_0x1ca792=![]){const _0xaf140c=a2_0x176d21;try{if(_0x1ca792)await Helper[_0xaf140c(0xec)](0x1f4,this[_0xaf140c(0xb6)],'Getting\x20User\x20Land\x20Info...',this);const _0x3613e4=await this[_0xaf140c(0x121)](_0xaf140c(0x127),'GET',this[_0xaf140c(0x11d)]);if(_0x3613e4[_0xaf140c(0xde)]){if(_0x1ca792)await Helper[_0xaf140c(0xec)](0x3e8,this['account'],_0xaf140c(0x132),this);this[_0xaf140c(0xd4)]=_0x3613e4[_0xaf140c(0x125)];}else await Helper[_0xaf140c(0xec)](0x1388,this[_0xaf140c(0xb6)],_0xaf140c(0xff)+_0x3613e4[_0xaf140c(0xd8)],this);}catch(_0x339b0a){throw _0x339b0a;}}async['plantSeed'](_0x1da99b){const _0x33a9d2=a2_0x176d21;try{await Helper[_0x33a9d2(0xec)](0x1f4,this[_0x33a9d2(0xb6)],_0x33a9d2(0xe6),this);const _0x221bca=await this[_0x33a9d2(0x121)](_0x33a9d2(0x101),_0x33a9d2(0x109),this[_0x33a9d2(0x11d)],{'plantId':this['plant'][0x0]['id'],'landId':_0x1da99b});_0x221bca[_0x33a9d2(0xde)]?(await Helper['delay'](0x3e8,this['account'],_0x33a9d2(0x102)+_0x1da99b,this),await this['getLands'](),await this[_0x33a9d2(0xbe)]()):await Helper[_0x33a9d2(0xec)](0x1388,this[_0x33a9d2(0xb6)],_0x33a9d2(0xff)+_0x221bca[_0x33a9d2(0xd8)],this);}catch(_0x5d218b){throw _0x5d218b;}}async[a2_0x176d21(0xc8)](){const _0x4b1295=a2_0x176d21;try{await Helper['delay'](0x1f4,this[_0x4b1295(0xb6)],_0x4b1295(0xe7),this);const _0x54a361=await this[_0x4b1295(0x121)](_0x4b1295(0xfe),_0x4b1295(0x109),this[_0x4b1295(0x11d)]);_0x54a361[_0x4b1295(0xde)]?(await Helper[_0x4b1295(0xec)](0x7d0,this['account'],_0x4b1295(0xc2)+_0x54a361[_0x4b1295(0x125)]['gem']+_0x4b1295(0xcf)+_0x54a361[_0x4b1295(0x125)][_0x4b1295(0xb7)]+_0x4b1295(0x12d),this),await this[_0x4b1295(0xf2)](),await this[_0x4b1295(0xfc)](),await this[_0x4b1295(0xbe)]()):await Helper['delay'](0x7d0,this['account'],''+_0x54a361[_0x4b1295(0xd8)],this);}catch(_0x13e464){throw _0x13e464;}}async[a2_0x176d21(0x10b)](_0x4801d3){const _0x17b37c=a2_0x176d21;try{if(_0x4801d3)await Helper[_0x17b37c(0xec)](0x1f4,this[_0x17b37c(0xb6)],_0x17b37c(0x129),this);const _0x56a950=await this['fetch'](_0x17b37c(0x107),_0x17b37c(0x100),this[_0x17b37c(0x11d)]);if(_0x56a950['success']){if(_0x4801d3)await Helper[_0x17b37c(0xec)](0xbb8,this[_0x17b37c(0xb6)],_0x17b37c(0x123),this);this[_0x17b37c(0xda)]=_0x56a950[_0x17b37c(0x125)];}else await Helper[_0x17b37c(0xec)](0xbb8,this['account'],''+_0x56a950['message'],this);}catch(_0x2e116c){throw _0x2e116c;}}async[a2_0x176d21(0xc0)](){const _0x6ae066=a2_0x176d21;try{await Helper[_0x6ae066(0xec)](0x1f4,this[_0x6ae066(0xb6)],'Buying\x20common\x20chest...',this);const _0x3a4767=await this[_0x6ae066(0x121)](_0x6ae066(0x128),_0x6ae066(0x112),this[_0x6ae066(0x11d)],{'storeId':0x2,'price':0x7530,'unit':0x1});_0x3a4767[_0x6ae066(0xde)]?(await this[_0x6ae066(0xf2)](),await this[_0x6ae066(0x135)]()):await Helper[_0x6ae066(0xec)](0xbb8,this[_0x6ae066(0xb6)],''+_0x3a4767[_0x6ae066(0xd8)],this);}catch(_0x3701aa){throw _0x3701aa;}}async[a2_0x176d21(0x135)](){const _0x22226f=a2_0x176d21;try{const _0x3c4c60=await this[_0x22226f(0x121)]('/api/v1/players/chest?limit=3000',_0x22226f(0x100),this['token']);_0x3c4c60[_0x22226f(0xde)]?this[_0x22226f(0xd9)]=_0x3c4c60[_0x22226f(0x125)]:await Helper[_0x22226f(0xec)](0xbb8,this['account'],''+res[_0x22226f(0xd8)],this);}catch(_0x2d9003){throw _0x2d9003;}}async[a2_0x176d21(0xc9)](){const _0x6e51a7=a2_0x176d21;try{const _0x16e47d=Config[_0x6e51a7(0x110)]??'A';await Helper[_0x6e51a7(0xec)](0x1f4,this[_0x6e51a7(0xb6)],_0x6e51a7(0x111),this);const _0x31824b=await this['fetch'](_0x6e51a7(0x130),_0x6e51a7(0x112),this[_0x6e51a7(0x11d)],{'petTypeIds':PetList[_0x6e51a7(0xc7)][_0x6e51a7(0x10e)](_0x281065=>_0x281065['type']==_0x16e47d)[_0x6e51a7(0x125)],'chestIds':this[_0x6e51a7(0xd9)][_0x6e51a7(0x124)](_0x13dee4=>{return _0x13dee4['id'];})});_0x31824b[_0x6e51a7(0xde)]?(await this[_0x6e51a7(0x135)](),await Helper[_0x6e51a7(0xec)](0x3e8,this[_0x6e51a7(0xb6)],_0x6e51a7(0xf1),this)):await Helper[_0x6e51a7(0xec)](0xbb8,this['account'],''+_0x31824b[_0x6e51a7(0xd8)],this);}catch(_0x33f698){throw _0x33f698;}}async[a2_0x176d21(0xd1)](_0x10d3ce){const _0x2cf781=a2_0x176d21;try{await Helper[_0x2cf781(0xec)](0x1f4,this[_0x2cf781(0xb6)],_0x2cf781(0xbc)+_0x10d3ce[_0x2cf781(0xed)]+_0x2cf781(0xf5)+_0x10d3ce[_0x2cf781(0xf3)]+_0x2cf781(0x133),this);const _0x30b90a=await this[_0x2cf781(0x121)](_0x2cf781(0xfa),_0x2cf781(0x112),this[_0x2cf781(0x11d)],{'level':_0x10d3ce[_0x2cf781(0xf3)],'petTypeId':PetList[_0x2cf781(0xbb)][_0x2cf781(0x10e)](_0x234dd5=>{const _0x53a64c=_0x2cf781;console[_0x53a64c(0xdb)](_0x53a64c(0x134)+_0x10d3ce[_0x53a64c(0xed)]+'\x20|\x20'+_0x234dd5[_0x53a64c(0xed)]),_0x234dd5[_0x53a64c(0xed)]==_0x10d3ce['name'];})[_0x2cf781(0x11e)]});_0x30b90a[_0x2cf781(0xde)]?(await this[_0x2cf781(0x10b)](),await Helper[_0x2cf781(0xec)](0x3e8,this[_0x2cf781(0xb6)],_0x2cf781(0xe0)+_0x10d3ce[_0x2cf781(0xed)]+_0x2cf781(0xf4)+(_0x10d3ce['level']+0x1)+'\x20',this)):await Helper['delay'](0xbb8,this[_0x2cf781(0xb6)],''+_0x30b90a['message'],this);}catch(_0x37a6c9){throw _0x37a6c9;}}async['claimGold'](){const _0x3ab063=a2_0x176d21;try{await Helper[_0x3ab063(0xec)](0x1f4,this[_0x3ab063(0xb6)],_0x3ab063(0xef),this);const _0x1e61b6=await this[_0x3ab063(0x121)](_0x3ab063(0x12c),_0x3ab063(0x112),this['token']);_0x1e61b6[_0x3ab063(0xde)]?(await this[_0x3ab063(0xf2)](),await Helper['delay'](0x3e8,this[_0x3ab063(0xb6)],'Successfully\x20Claim\x20Gold,\x20got\x20'+_0x1e61b6[_0x3ab063(0x125)][_0x3ab063(0xea)]+_0x3ab063(0x12d),this)):await Helper['delay'](0xbb8,this['account'],''+_0x1e61b6[_0x3ab063(0xd8)],this);}catch(_0xf8e869){throw _0xf8e869;}}async[a2_0x176d21(0xf0)](){const _0x574a5e=a2_0x176d21;let _0x4211c6=[];for(const _0x1fbbd3 of this[_0x574a5e(0xda)]){const _0x14cbc3=_0x4211c6[_0x574a5e(0x10e)](_0x2e1a1f=>_0x2e1a1f[_0x574a5e(0xed)]===_0x1fbbd3['name']&&_0x2e1a1f[_0x574a5e(0xf3)]===_0x1fbbd3[_0x574a5e(0xf3)]);_0x14cbc3?_0x14cbc3[_0x574a5e(0x114)]+=0x1:_0x4211c6[_0x574a5e(0xd3)]({..._0x1fbbd3,'count':0x1});}return _0x4211c6=_0x4211c6[_0x574a5e(0xf7)](_0x15dc95=>_0x15dc95[_0x574a5e(0x114)]>=0x5),_0x4211c6;}}