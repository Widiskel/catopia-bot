const a2_0x417381=a2_0x2187;function a2_0x2187(_0x31c7c7,_0x16ad15){const _0x46ef79=a2_0x46ef();return a2_0x2187=function(_0x2187e7,_0x54bd6f){_0x2187e7=_0x2187e7-0x13e;let _0xb0fc88=_0x46ef79[_0x2187e7];return _0xb0fc88;},a2_0x2187(_0x31c7c7,_0x16ad15);}(function(_0x6fcc98,_0x449e9e){const _0x1a3f59=a2_0x2187,_0x42d0d0=_0x6fcc98();while(!![]){try{const _0x96e116=-parseInt(_0x1a3f59(0x191))/0x1*(-parseInt(_0x1a3f59(0x19b))/0x2)+-parseInt(_0x1a3f59(0x160))/0x3+parseInt(_0x1a3f59(0x15e))/0x4*(parseInt(_0x1a3f59(0x174))/0x5)+parseInt(_0x1a3f59(0x19e))/0x6+-parseInt(_0x1a3f59(0x17a))/0x7+parseInt(_0x1a3f59(0x16e))/0x8*(-parseInt(_0x1a3f59(0x195))/0x9)+parseInt(_0x1a3f59(0x19f))/0xa*(-parseInt(_0x1a3f59(0x176))/0xb);if(_0x96e116===_0x449e9e)break;else _0x42d0d0['push'](_0x42d0d0['shift']());}catch(_0x59c953){_0x42d0d0['push'](_0x42d0d0['shift']());}}}(a2_0x46ef,0x21224));import{API}from'../api/api.js';function a2_0x46ef(){const _0x54633f=['Successfully\x20Login','Opening\x20multipe\x20chest...','Try\x20to\x20Login...','getSeedList','Successfully\x20Get\x20User\x20Land\x20Info','fetch','Successfully\x20Harvest\x20All\x20Plant\x20Got\x20','WSS\x20Handshake\x20completed\x20and\x20connected.','172PWrHPC','pet','86721FsfGjH','Getting\x20Missions...','https://api.catopia.io','getLands','Successfully\x20Get\x20User\x20Info','WSS\x20Error\x20:\x20','POSt','getPet','upgradePet','Getting\x20User\x20Info...','socket','reduce','level','Socket\x20ID:\x20','600sRAeCf','getChest','Connecting\x20to\x20WSS...','/api/v1/players/plant?limit=3000','getAvailablePlant','plainToken','23285cIXuVQ','/api/v1/user/daily-mission?limit=3000','261668TpQbcQ','chest','query','plantString','294140qRQgdi','openChest','info','/api/v1/seed?limit=3000','claimMission','Buying\x20Grapes...','/api/v1/user/daily-mission/','/claim','/api/v1/players/pet?limit=3000','harvestAll','find','connect_timeout','data','connect','getMission','WSS\x20Connected...','toLowerCase','token','disconnect','/api/v1/players/plant/harvestAll','/api/v1/store/buy','Getting\x20Seed\x20List...','plant','22706dHSLtj','buyChest','Buying\x20common\x20chest...','petTypeId','18648YwiING','land','/api/v1/players/pet/upgrade','/api/v1/chest/open-multiple','POST','delay','12qYxhLO','Successfully\x20Get\x20Misisons','Successfully\x20Buying\x201\x20Grapes','581520QCfXAY','30HvtfxW','petTypeList','queryObj','Successfully\x20Opening\x20Multiple\x20Chest','\x20GOLD','getUser','missions','\x20GEM\x20&\x20','account','WSS\x20Connection\x20Closed\x20','success','GET','/api/v1/auth/telegram','WSS\x20Connection\x20Error:\x20','Harvesting\x20all...','wss://cowtopia-ws.tonfarmer.com','message','mission','Error\x20:\x20','login','buyingGrapes','Successfully\x20get\x20player\x20pet','entries','map','type','error','Successfully\x20Upgrading\x20Pet','gem','/api/v1/players/land?limit=3000','connect_error','/api/v1/user-collection?limit=3000','Successfully\x20Get\x20Seed\x20List','Getting\x20User\x20Land\x20Info...','websocket','Successfully\x20Get\x20Player\x20Plant','/api/v1/players/chest?limit=3000','name','WSS\x20Disconnected:\x20','gold','...','Upgrading\x20pet\x20','refreshToken'];a2_0x46ef=function(){return _0x54633f;};return a2_0x46ef();}import{Helper}from'../utils/helper.js';import a2_0x1c4016 from'../utils/logger.js';import{io}from'socket.io-client';import{PetList}from'./pet_list.js';export class Catopia extends API{constructor(_0x5dd673,_0x5aae5d,_0x83748e){const _0xfe782c=a2_0x2187;super(_0x5aae5d,_0xfe782c(0x162)),this['account']=_0x5dd673,this[_0xfe782c(0x178)]=_0x5aae5d,this[_0xfe782c(0x1a1)]=_0x83748e;}async[a2_0x417381(0x13f)](){const _0x37457c=a2_0x417381;try{await Helper[_0x37457c(0x19a)](0x1f4,this[_0x37457c(0x1a7)],_0x37457c(0x158),this);const _0x3cf00b=await this[_0x37457c(0x15b)](_0x37457c(0x1ab),'POST',undefined,{'initData':this[_0x37457c(0x178)]});await Helper[_0x37457c(0x19a)](0x3e8,this['account'],_0x37457c(0x156),this),this[_0x37457c(0x18b)]=_0x3cf00b['data']['accessToken'],this[_0x37457c(0x155)]=_0x3cf00b[_0x37457c(0x155)];}catch(_0x58d4e6){throw _0x58d4e6;}}async[a2_0x417381(0x1a4)](_0x544eab=![]){const _0x293aaa=a2_0x417381;try{if(_0x544eab)await Helper['delay'](0x1f4,this['account'],_0x293aaa(0x169),this);const _0x20be6d=await this[_0x293aaa(0x15b)](_0x293aaa(0x14a),'GET',this[_0x293aaa(0x18b)]);if(_0x20be6d['success']==!![]){if(_0x544eab)await Helper[_0x293aaa(0x19a)](0x3e8,this[_0x293aaa(0x1a7)],_0x293aaa(0x164),this);this['user']=_0x20be6d[_0x293aaa(0x186)];}else await Helper[_0x293aaa(0x19a)](0x1388,this[_0x293aaa(0x1a7)],'Error\x20:\x20'+_0x20be6d[_0x293aaa(0x1af)],this);}catch(_0xe6d3f5){throw _0xe6d3f5;}}async['initWss'](){return new Promise(async(_0x32546e,_0x2e75ba)=>{const _0x188831=a2_0x2187;await Helper[_0x188831(0x19a)](0x3e8,this[_0x188831(0x1a7)],_0x188831(0x170),this),this[_0x188831(0x16a)]=io(_0x188831(0x1ae),{'auth':{'token':this[_0x188831(0x173)]},'transports':[_0x188831(0x14d)]}),this[_0x188831(0x16a)]['on'](_0x188831(0x187),async()=>{const _0x415d69=_0x188831;await Helper[_0x415d69(0x19a)](0x3e8,this[_0x415d69(0x1a7)],_0x415d69(0x189),this),a2_0x1c4016[_0x415d69(0x17c)](_0x415d69(0x15d)),a2_0x1c4016[_0x415d69(0x17c)](_0x415d69(0x16d)+this[_0x415d69(0x16a)]['id']),_0x32546e();}),this[_0x188831(0x16a)]['on'](_0x188831(0x149),async _0x262fba=>{const _0x4624b5=_0x188831;await Helper[_0x4624b5(0x19a)](0x3e8,this['account'],_0x4624b5(0x1ac)+_0x262fba[_0x4624b5(0x1af)],this),a2_0x1c4016[_0x4624b5(0x145)]('WSS\x20Handshake\x20Error:\x20'+_0x262fba[_0x4624b5(0x1af)]),_0x2e75ba(_0x262fba);}),this[_0x188831(0x16a)]['on'](_0x188831(0x185),async()=>{const _0x557806=_0x188831;await Helper[_0x557806(0x19a)](0x3e8,this['account'],'WSS\x20Connection\x20Timeout',this),a2_0x1c4016[_0x557806(0x145)]('WSS\x20Handshake\x20Timeout'),_0x2e75ba(new Error('WSS\x20Handshake\x20Timeout'));}),this[_0x188831(0x16a)]['on'](_0x188831(0x145),async _0x17cab1=>{const _0x5a2d4d=_0x188831;await Helper[_0x5a2d4d(0x19a)](0x3e8,this[_0x5a2d4d(0x1a7)],_0x5a2d4d(0x165)+_0x17cab1[_0x5a2d4d(0x1af)],this),a2_0x1c4016['error'](_0x5a2d4d(0x165)+_0x17cab1[_0x5a2d4d(0x1af)]),_0x2e75ba(_0x17cab1);}),this[_0x188831(0x16a)]['on'](_0x188831(0x18c),async _0x52156a=>{const _0x3c7a1c=_0x188831;await Helper['delay'](0x3e8,this['account'],_0x3c7a1c(0x1a8)+_0x52156a+_0x3c7a1c(0x153),this),a2_0x1c4016[_0x3c7a1c(0x17c)](_0x3c7a1c(0x151)+_0x52156a);});});}async[a2_0x417381(0x188)](_0x23055a=![]){const _0x5b3e55=a2_0x417381;try{if(_0x23055a)await Helper[_0x5b3e55(0x19a)](0x1f4,this[_0x5b3e55(0x1a7)],_0x5b3e55(0x161),this);this[_0x5b3e55(0x1a5)]=[];const _0x558fb1=await this[_0x5b3e55(0x15b)](_0x5b3e55(0x175),'GET',this[_0x5b3e55(0x18b)]);if(_0x558fb1[_0x5b3e55(0x1a9)]){if(_0x23055a)await Helper[_0x5b3e55(0x19a)](0x3e8,this[_0x5b3e55(0x1a7)],_0x5b3e55(0x19c),this);this[_0x5b3e55(0x1a5)]=_0x558fb1[_0x5b3e55(0x186)];}else await Helper[_0x5b3e55(0x19a)](0x1388,this['account'],_0x5b3e55(0x13e)+_0x558fb1['message'],this);}catch(_0x384573){throw _0x384573;}}async[a2_0x417381(0x17e)](_0x4d1d37){const _0x5a4448=a2_0x417381;try{await Helper[_0x5a4448(0x19a)](0x1f4,this['account'],'Claiming\x20Missions\x20'+_0x4d1d37[_0x5a4448(0x1b0)]['title']+_0x5a4448(0x153),this);const _0x23ac74=await this[_0x5a4448(0x15b)](_0x5a4448(0x180)+_0x4d1d37['id']+_0x5a4448(0x181),_0x5a4448(0x199),this['token']);_0x23ac74[_0x5a4448(0x1a9)]?(await Helper[_0x5a4448(0x19a)](0x3e8,this['account'],'Successfully\x20Claim\x20Misisons',this),await this[_0x5a4448(0x1a4)](),await this[_0x5a4448(0x188)]()):await Helper['delay'](0x1388,this[_0x5a4448(0x1a7)],_0x5a4448(0x13e)+_0x23ac74['message'],this);}catch(_0x597732){throw _0x597732;}}async[a2_0x417381(0x159)](){const _0x6c6cdf=a2_0x417381;try{await Helper[_0x6c6cdf(0x19a)](0x1f4,this[_0x6c6cdf(0x1a7)],_0x6c6cdf(0x18f),this);const _0x502607=await this[_0x6c6cdf(0x15b)](_0x6c6cdf(0x17d),_0x6c6cdf(0x1aa),this[_0x6c6cdf(0x18b)]);_0x502607[_0x6c6cdf(0x1a9)]?(await Helper[_0x6c6cdf(0x19a)](0x3e8,this[_0x6c6cdf(0x1a7)],_0x6c6cdf(0x14b),this),this['seed']=_0x502607['data']):await Helper[_0x6c6cdf(0x19a)](0x1388,this[_0x6c6cdf(0x1a7)],'Error\x20:\x20'+_0x502607[_0x6c6cdf(0x1af)],this);}catch(_0x3629fe){throw _0x3629fe;}}async[a2_0x417381(0x172)](_0x5a796a=![]){const _0x514900=a2_0x417381;try{if(_0x5a796a)await Helper['delay'](0x1f4,this[_0x514900(0x1a7)],'Getting\x20Player\x20Plant...',this);const _0x106a88=await this[_0x514900(0x15b)](_0x514900(0x171),_0x514900(0x1aa),this[_0x514900(0x18b)]);if(_0x106a88[_0x514900(0x1a9)]){if(_0x5a796a)await Helper[_0x514900(0x19a)](0x3e8,this[_0x514900(0x1a7)],_0x514900(0x14e),this);this['plant']=_0x106a88[_0x514900(0x186)];const _0x3413b5=this[_0x514900(0x190)][_0x514900(0x16b)]((_0x449923,_0x374b3c)=>{const _0x28eeb7=_0x514900,_0x5e0fe9=_0x374b3c[_0x28eeb7(0x150)][_0x28eeb7(0x18a)]();return _0x449923[_0x5e0fe9]=(_0x449923[_0x5e0fe9]||0x0)+0x1,_0x449923;},{});this[_0x514900(0x179)]=Object[_0x514900(0x142)](_0x3413b5)['map'](([_0x2bbf76,_0x364810])=>_0x364810+'\x20'+_0x2bbf76+(_0x364810>0x1?'s':''))['join']('\x20');}else await Helper[_0x514900(0x19a)](0x1388,this[_0x514900(0x1a7)],_0x514900(0x13e)+_0x106a88[_0x514900(0x1af)],this);}catch(_0x588296){throw _0x588296;}}async[a2_0x417381(0x140)](){const _0x950678=a2_0x417381;try{await Helper[_0x950678(0x19a)](0x1f4,this[_0x950678(0x1a7)],_0x950678(0x17f),this);const _0x12771b=await this[_0x950678(0x15b)](_0x950678(0x18e),_0x950678(0x199),this[_0x950678(0x18b)],{'storeId':0x11,'price':0x3e80,'unit':0x1});await this[_0x950678(0x1a4)](),_0x12771b[_0x950678(0x1a9)]?(await Helper[_0x950678(0x19a)](0x3e8,this['account'],_0x950678(0x19d),this),await this[_0x950678(0x172)]()):(await Helper[_0x950678(0x19a)](0x1388,this[_0x950678(0x1a7)],''+_0x12771b['message'],this),await this[_0x950678(0x183)]());}catch(_0x52f609){throw _0x52f609;}}async[a2_0x417381(0x163)](_0x3f98c3=![]){const _0x172a6b=a2_0x417381;try{if(_0x3f98c3)await Helper['delay'](0x1f4,this[_0x172a6b(0x1a7)],_0x172a6b(0x14c),this);const _0x498a77=await this[_0x172a6b(0x15b)](_0x172a6b(0x148),_0x172a6b(0x1aa),this[_0x172a6b(0x18b)]);if(_0x498a77[_0x172a6b(0x1a9)]){if(_0x3f98c3)await Helper['delay'](0x3e8,this[_0x172a6b(0x1a7)],_0x172a6b(0x15a),this);this[_0x172a6b(0x196)]=_0x498a77[_0x172a6b(0x186)];}else await Helper[_0x172a6b(0x19a)](0x1388,this['account'],_0x172a6b(0x13e)+_0x498a77[_0x172a6b(0x1af)],this);}catch(_0x5887f9){throw _0x5887f9;}}async['plantSeed'](_0x4ec3f1){const _0x264cda=a2_0x417381;try{await Helper[_0x264cda(0x19a)](0x1f4,this['account'],'Planting\x20Gapes\x20seed\x20to\x20land...',this);const _0x5300cc=await this[_0x264cda(0x15b)]('/api/v1/players/plant',_0x264cda(0x166),this[_0x264cda(0x18b)],{'plantId':this[_0x264cda(0x190)][0x0]['id'],'landId':_0x4ec3f1});_0x5300cc[_0x264cda(0x1a9)]?(await Helper['delay'](0x3e8,this[_0x264cda(0x1a7)],'Successfully\x20planting\x20grapes\x20to\x20land\x20'+_0x4ec3f1,this),await this[_0x264cda(0x163)](),await this[_0x264cda(0x172)]()):await Helper['delay'](0x1388,this[_0x264cda(0x1a7)],_0x264cda(0x13e)+_0x5300cc[_0x264cda(0x1af)],this);}catch(_0x37d800){throw _0x37d800;}}async[a2_0x417381(0x183)](){const _0x46d40f=a2_0x417381;try{await Helper[_0x46d40f(0x19a)](0x1f4,this['account'],_0x46d40f(0x1ad),this);const _0x5bd6db=await this['fetch'](_0x46d40f(0x18d),_0x46d40f(0x166),this[_0x46d40f(0x18b)]);_0x5bd6db[_0x46d40f(0x1a9)]?(await Helper['delay'](0x7d0,this[_0x46d40f(0x1a7)],_0x46d40f(0x15c)+_0x5bd6db['data'][_0x46d40f(0x147)]+_0x46d40f(0x1a6)+_0x5bd6db[_0x46d40f(0x186)][_0x46d40f(0x152)]+_0x46d40f(0x1a3),this),await this[_0x46d40f(0x1a4)](),await this['getLands'](),await this['getAvailablePlant']()):await Helper[_0x46d40f(0x19a)](0x7d0,this[_0x46d40f(0x1a7)],''+_0x5bd6db[_0x46d40f(0x1af)],this);}catch(_0x445d96){throw _0x445d96;}}async[a2_0x417381(0x167)](_0x4b0564){const _0x4ccff0=a2_0x417381;try{if(_0x4b0564)await Helper['delay'](0x1f4,this['account'],'Getting\x20player\x20pet...',this);const _0x1a98f3=await this['fetch'](_0x4ccff0(0x182),'GET',this['token']);if(_0x1a98f3[_0x4ccff0(0x1a9)]){if(_0x4b0564)await Helper[_0x4ccff0(0x19a)](0xbb8,this['account'],_0x4ccff0(0x141),this);this[_0x4ccff0(0x15f)]=_0x1a98f3[_0x4ccff0(0x186)];}else await Helper[_0x4ccff0(0x19a)](0xbb8,this['account'],''+_0x1a98f3[_0x4ccff0(0x1af)],this);}catch(_0x3d265a){throw _0x3d265a;}}async[a2_0x417381(0x192)](){const _0x365392=a2_0x417381;try{await Helper[_0x365392(0x19a)](0x1f4,this[_0x365392(0x1a7)],_0x365392(0x193),this);const _0x4de38d=await this[_0x365392(0x15b)](_0x365392(0x18e),_0x365392(0x199),this[_0x365392(0x18b)],{'storeId':0x2,'price':0x7530,'unit':0x1});_0x4de38d[_0x365392(0x1a9)]?(await this[_0x365392(0x1a4)](),await this[_0x365392(0x16f)]()):await Helper[_0x365392(0x19a)](0xbb8,this[_0x365392(0x1a7)],''+_0x4de38d['message'],this);}catch(_0x1521b9){throw _0x1521b9;}}async['getChest'](){const _0x2eb003=a2_0x417381;try{const _0x2a237e=await this[_0x2eb003(0x15b)](_0x2eb003(0x14f),_0x2eb003(0x1aa),this[_0x2eb003(0x18b)]);_0x2a237e['success']?this[_0x2eb003(0x177)]=_0x2a237e[_0x2eb003(0x186)]:await Helper[_0x2eb003(0x19a)](0xbb8,this[_0x2eb003(0x1a7)],''+res[_0x2eb003(0x1af)],this);}catch(_0x1e2594){throw _0x1e2594;}}async[a2_0x417381(0x17b)](){const _0xb57f84=a2_0x417381;try{await Helper['delay'](0x1f4,this[_0xb57f84(0x1a7)],_0xb57f84(0x157),this);const _0x14a18f=await this[_0xb57f84(0x15b)](_0xb57f84(0x198),_0xb57f84(0x199),this[_0xb57f84(0x18b)],{'petTypeIds':PetList['petCompanion'][_0xb57f84(0x184)](_0x8619f8=>_0x8619f8[_0xb57f84(0x144)]=='A')['data'],'chestIds':this[_0xb57f84(0x177)][_0xb57f84(0x143)](_0x335c61=>{return _0x335c61['id'];})});_0x14a18f[_0xb57f84(0x1a9)]?(await this['getChest'](),await Helper['delay'](0x3e8,this['account'],_0xb57f84(0x1a2),this)):await Helper['delay'](0xbb8,this[_0xb57f84(0x1a7)],''+_0x14a18f['message'],this);}catch(_0x3d0c26){throw _0x3d0c26;}}async[a2_0x417381(0x168)](_0x1bda04){const _0x1e5482=a2_0x417381;try{await Helper[_0x1e5482(0x19a)](0x1f4,this[_0x1e5482(0x1a7)],_0x1e5482(0x154)+_0x1bda04[_0x1e5482(0x150)]+_0x1e5482(0x153),this);const _0x261e87=await this['fetch'](_0x1e5482(0x197),_0x1e5482(0x199),this[_0x1e5482(0x18b)],{'level':_0x1bda04[_0x1e5482(0x16c)],'petTypeId':PetList[_0x1e5482(0x1a0)][_0x1e5482(0x184)](_0x3781b1=>_0x3781b1[_0x1e5482(0x150)]==_0x1bda04[_0x1e5482(0x150)])[_0x1e5482(0x194)]});_0x261e87[_0x1e5482(0x1a9)]?(await this[_0x1e5482(0x167)](),await Helper[_0x1e5482(0x19a)](0x3e8,this['account'],_0x1e5482(0x146),this)):await Helper[_0x1e5482(0x19a)](0xbb8,this['account'],''+_0x261e87['message'],this);}catch(_0x58d6a0){throw _0x58d6a0;}}}